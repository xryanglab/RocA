<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>**Reanalysis of ribosome profiling datasets reveals a novel function of rocaglamide A in perturbing the dynamics of translation elongation via eIF4A**</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="xd5x" id="reanalysis-of-ribosome-profiling-datasets-reveals-a-novel-function-of-rocaglamide-a-in-perturbing-the-dynamics-of-translation-elongation-via-eif4a"><strong>Reanalysis of ribosome profiling datasets reveals a novel function of rocaglamide A in perturbing the dynamics of translation elongation via eIF4A</strong></h1><p data-anchor-id="3zee"><strong>Fajin Li<sup>1,2,3,4</sup></strong>, <strong>Jianhuo Fang<sup>1,4</sup></strong>, <strong>Yifan Yu<sup>1,4</sup></strong>, Sijia Hao<sup>1,2,3</sup>, Qinglin Zeng<sup>1</sup>, Qin Zou<sup>1</sup>, and <strong>Xuerui Yang<sup>1,2,3</sup></strong></p><p data-anchor-id="tfqj"><sup>1</sup> MOE Key Laboratory of Bioinformatics, School of Life Sciences, Tsinghua University, Beijing 100084, China <br>
<sup>2</sup> Center for Synthetic &amp; Systems Biology, Tsinghua University, Beijing 100084, China <br>
<sup>3</sup> Joint Graduate Program of Peking-Tsinghua-National Institute of Biological Science, Tsinghua University, Beijing 100084, China. <br>
<sup>4</sup> These authors are main contributors to this work.</p><p data-anchor-id="5qz3">Corresponding： yangxuerui@tsinghua.edu.cn; lfj17@tsinghua.org.cn; sherkinglee@gmail.com</p><hr><div class="md-section-divider"></div><h2 data-anchor-id="e67m" id="introduction"><strong>Introduction</strong></h2><p data-anchor-id="i4iw">This file is a description of how the results presented in the manuscript were generated, including the datasets we used, how we downloaded and processed the raw datasets, the codes we used, et al. All scripts used for processing BAM files should be excuted in Linux platform and other scripts can be both used in Linux and windows platform. It should be noted that most of the analyses were based on <a href="https://github.com/xryanglab/RiboMiner" target="_blank">RiboMiner</a> we developed before.</p><div class="md-section-divider"></div><h2 data-anchor-id="g7y3" id="datasets"><strong>Datasets</strong></h2><p data-anchor-id="l3pr">The datasets we used were all downloaded from <a href="https://www.ncbi.nlm.nih.gov/gds" target="_blank">GEO</a> database. We all collected 26 datasets, containing more than 100 ribosome profiling samples and several iCLIP-seq samples. Please refer to <a href="https://github.com/sherkinglee/RocA/blob/main/metadata/TableS1.xlsx" target="_blank">Table S1</a> for the detailed information of all the collected datasets.</p><p data-anchor-id="mqrt">The codes used for downloading all the datasets are:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="z7jt"><ol class="linenums"><li class="L0"><code><span class="com"># use GSE102720 as an example:</span></code></li><li class="L1"><code><span class="pln">$ cat download</span><span class="pun">.</span><span class="pln">sh</span></code></li><li class="L2"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">/workdata/</span><span class="typ">LabMember2</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="typ">Project</span><span class="pun">/</span><span class="lit">05.Ribo</span><span class="pln">_seq_human</span><span class="pun">/</span><span class="pln">GSE102720</span><span class="pun">/</span><span class="lit">00.rawdata</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> SRR59376</span><span class="pun">{</span><span class="lit">40.</span><span class="pun">.</span><span class="lit">45</span><span class="pun">};</span><span class="kwd">do</span></code></li><li class="L5"><code><span class="pln">    fastq</span><span class="pun">-</span><span class="kwd">dump</span><span class="pln"> $i</span></code></li><li class="L6"><code><span class="pln">    rm </span><span class="pun">/</span><span class="pln">workdata</span><span class="pun">/</span><span class="typ">LabMember2</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">ncbi</span><span class="pun">/</span><span class="kwd">public</span><span class="pun">/</span><span class="pln">sra</span><span class="pun">/</span><span class="pln">$i</span><span class="pun">.</span><span class="pln">sra</span></code></li><li class="L7"><code><span class="kwd">done</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="zak8" id="dependencies"><strong>Dependencies</strong></h2><ul data-anchor-id="6iki">
<li>python &gt;= 3.6</li>
<li>RiboMiner = 0.2.3.2</li>
<li>snakemake = 5.31.1</li>
<li>sra-tools = 2.11.0</li>
<li>fastx_toolkit = 0.0.14</li>
<li>cutadapt = 4.0</li>
<li>bowtie &gt;= 1.1.2</li>
<li>STAR = 2.7.7a</li>
<li>samtools = 1.11</li>
<li>R &gt;= 3.6</li>
</ul><hr><div class="md-section-divider"></div><h2 data-anchor-id="hzfk" id="preparations"><strong>Preparations</strong></h2><p data-anchor-id="x7ut">The human reference genome, ncRNA and annotations are downloaded from <a href="https://asia.ensembl.org/index.html" target="_blank">Ensemble Genome Browser (release 88)</a>. Human rRNA sequences are downloaded from <a href="https://genome.ucsc.edu/" target="_blank">UCSC Genome Browser</a> and download method could refer to <a href="https://www.jove.com/t/63366/de-novo-identification-actively-translated-open-reading-frames-with" target="_blank">this protocol</a>.</p><ul data-anchor-id="909r">
<li>Download and install some tools and packages</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7juc"><ol class="linenums"><li class="L0"><code><span class="com"># python &gt;=3.6</span></code></li><li class="L1"><code><span class="pln">conda install </span><span class="pun">-</span><span class="pln">c bioconda ribocode ribominer sra</span><span class="pun">-</span><span class="pln">tools</span></code></li><li class="L2"><code><span class="pln">fastx_toolkit cutadapt bowtie star samtools snakemake</span></code></li></ol></pre><ul data-anchor-id="aus6">
<li>Build index for rRNA alignment:</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="u5rc"><ol class="linenums"><li class="L0"><code><span class="pln">fastaGenome</span><span class="pun">=</span><span class="pln">hg38_rRNA</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L1"><code><span class="pln">bowtie</span><span class="pun">-</span><span class="pln">build </span><span class="pun">-</span><span class="pln">f $fastaGenome human_rRNA</span></code></li></ol></pre><ul data-anchor-id="3xtt">
<li>Build index for genome alignment:</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8nnp"><ol class="linenums"><li class="L0"><code><span class="pln">fastaGenome</span><span class="pun">=</span><span class="typ">Homo_sapiens</span><span class="pun">.</span><span class="typ">GRCh38</span><span class="pun">.</span><span class="pln">dna</span><span class="pun">.</span><span class="pln">primary_assembly</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L1"><code><span class="pln">gtf</span><span class="pun">=</span><span class="typ">Homo_sapiens</span><span class="pun">.</span><span class="typ">GRCh38</span><span class="pun">.</span><span class="lit">88.gtf</span></code></li><li class="L2"><code><span class="pln">srun STAR </span><span class="pun">--</span><span class="pln">runThreadN </span><span class="lit">8</span><span class="pln"> </span><span class="pun">--</span><span class="pln">runMode genomeGenerate </span><span class="pun">--</span><span class="pln">genomeDir </span><span class="pun">./</span><span class="pln">STAR_Human_Ensembl_GRCh38_Ensembl </span><span class="pun">--</span><span class="pln">genomeFastaFiles $fastaGenome </span><span class="pun">--</span><span class="pln">sjdbGTFfile $gtf</span></code></li></ol></pre><ul data-anchor-id="s2bh">
<li>Get annotations for transcriptome</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="udry"><ol class="linenums"><li class="L0"><code><span class="pln">prepare_transcripts </span><span class="pun">-</span><span class="pln">g </span><span class="pun">&lt;</span><span class="typ">Homo_sapiens</span><span class="pun">.</span><span class="typ">GRCh38</span><span class="pun">.</span><span class="lit">88.gtf</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f </span><span class="pun">&lt;</span><span class="typ">Homo_sapiens</span><span class="pun">.</span><span class="typ">GRCh38</span><span class="pun">.</span><span class="pln">dna</span><span class="pun">.</span><span class="pln">primary_assembly</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o </span><span class="pun">&lt;</span><span class="typ">RiboCode_annot</span><span class="pun">&gt;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="typ">OutputTranscriptInfo</span><span class="pln"> </span><span class="pun">-</span><span class="pln">c </span><span class="pun">&lt;</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_cds</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">g </span><span class="pun">&lt;</span><span class="typ">Homo_sapiens</span><span class="pun">.</span><span class="typ">GRCh38</span><span class="pun">.</span><span class="lit">88.gtf</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f </span><span class="pun">&lt;</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o </span><span class="pun">&lt;</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">O </span><span class="pun">&lt;</span><span class="pln">all</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">&gt;</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="1nug" id="pre-processing-of-ribosome-profiling-and-disome-seq-data"><strong>Pre-processing of ribosome profiling and Disome-seq data</strong></h2><p data-anchor-id="p43v">All ribosome profiling and Disome-seq datasets were processed with a custom <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/Ribo-seq-snakemake.py" target="_blank"><strong>snakemake</strong></a> pipeline. Use GSE102720 as an example，run the snakemake file:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rgai"><ol class="linenums"><li class="L0"><code><span class="pln">snakemake </span><span class="pun">-</span><span class="pln">s </span><span class="typ">Ribo</span><span class="pun">-</span><span class="pln">seq</span><span class="pun">-</span><span class="pln">snakemake</span><span class="pun">.</span><span class="pln">py  </span><span class="pun">--</span><span class="pln">cluster </span><span class="str">"sbatch -p cmp -N 2 -n 8 -e Ribo.err -o Ribo.out "</span><span class="pln"> </span><span class="pun">--</span><span class="pln">jobs </span><span class="lit">61</span></code></li></ol></pre><hr><div class="md-section-divider"></div><h2 data-anchor-id="nb38" id="formal-analyses"><strong>Formal analyses</strong></h2><p data-anchor-id="hu9w">Before doing the following analyses, all datasets we collected should be processed with the <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/Ribo-seq-snakemake.py" target="_blank">Ribo-seq-pipeline</a>.</p><div class="md-section-divider"></div><h3 data-anchor-id="wly3" id="calculate-polarity-scores-for-each-datasets"><strong>Calculate polarity scores for each datasets</strong></h3><ul data-anchor-id="lnxg">
<li>Set configure files (<a href="https://github.com/sherkinglee/RocA/blob/main/metadata/GSE102720_configure.txt" target="_blank">GSE102720</a> for example)</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="exvp"><ol class="linenums"><li class="L0"><code><span class="pln">bamFiles        readLengths     </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L1"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR5937640_STAR</span><span class="pun">/</span><span class="pln">SRR5937640</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">       </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">       </span><span class="typ">Naive</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="lit">1</span></code></li><li class="L2"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR5937641_STAR</span><span class="pun">/</span><span class="pln">SRR5937641</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">       </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">       </span><span class="typ">Naive</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="lit">2</span></code></li><li class="L3"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR5937642_STAR</span><span class="pun">/</span><span class="pln">SRR5937642</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">       </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">       </span><span class="typ">Naive</span><span class="pun">-</span><span class="typ">RocA03</span></code></li><li class="L4"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR5937643_STAR</span><span class="pun">/</span><span class="pln">SRR5937643</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">       </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">       </span><span class="typ">Aglaiacized</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="lit">1</span></code></li><li class="L5"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR5937644_STAR</span><span class="pun">/</span><span class="pln">SRR5937644</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">       </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">       </span><span class="typ">Aglaiacized</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="lit">2</span></code></li><li class="L6"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR5937645_STAR</span><span class="pun">/</span><span class="pln">SRR5937645</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">       </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">       </span><span class="typ">Aglaiacized</span><span class="pun">-</span><span class="typ">RocA03</span></code></li></ol></pre><ul data-anchor-id="sxrv">
<li>Calculate polarity scores using <a href="https://github.com/xryanglab/RiboMiner" target="_blank"><strong>RiboMiner</strong></a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="quxe"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE102720_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'Naive-DMSO,Naive-RocA03,Aglaiacized-DMSO,Aglaiacized-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'Naive-DMSO-1,Naive-DMSO-2__Naive-RocA03__Aglaiacized-DMSO-1,Aglaiacized-DMSO-2__Aglaiacized-RocA03'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="typ">PolarityCalculation</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_all </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span></code></li><li class="L1"><code><span class="typ">PlotPolarity</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i  $results</span><span class="pun">/</span><span class="pln">MA_all_polarity_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_all </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">y </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode all</span></code></li></ol></pre><ul data-anchor-id="m67c">
<li>Calculate the difference of polarity scores</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="r3kd"><ol class="linenums"><li class="L0"><code><span class="kwd">import</span><span class="pln"> pandas </span><span class="kwd">as</span><span class="pln"> pd</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">df</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="pln">read_csv</span><span class="pun">(</span><span class="str">'MA_all_mean_polarity_dataframe.txt'</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">)</span></code></li><li class="L3"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">)</span></code></li><li class="L4"><code><span class="com">##19636,5</span></code></li><li class="L5"><code><span class="pln">m</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">df</span><span class="pun">.</span><span class="pln">shape</span></code></li><li class="L6"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">iloc</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">5</span><span class="pun">,</span><span class="lit">0</span><span class="pun">:(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)])</span></code></li><li class="L7"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">columns</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">df</span><span class="pun">.</span><span class="pln">rename</span><span class="pun">(</span><span class="pln">columns</span><span class="pun">={</span><span class="str">'Unnamed: 0'</span><span class="pun">:</span><span class="str">'transcript_id'</span><span class="pun">},</span><span class="pln"> inplace </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span></code></li><li class="L9"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">columns</span><span class="pun">)</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">df</span><span class="pun">[</span><span class="str">'Naive-RocA03-DMSO(GSE102720)'</span><span class="pun">]=</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Naive-RocA03'</span><span class="pun">]-</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Naive-DMSO'</span><span class="pun">]</span></code></li><li class="L2"><code><span class="pln">df</span><span class="pun">[</span><span class="str">'Aglaiacized-RocA03-DMSO(GSE102720)'</span><span class="pun">]=</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Aglaiacized-RocA03'</span><span class="pun">]-</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Aglaiacized-DMSO'</span><span class="pun">]</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">df_new</span><span class="pun">=</span><span class="pln">df</span><span class="pun">[[</span><span class="str">'transcript_id'</span><span class="pun">,</span><span class="str">'Naive-RocA03-DMSO(GSE102720)'</span><span class="pun">,</span><span class="str">'Aglaiacized-RocA03-DMSO(GSE102720)'</span><span class="pun">]]</span></code></li><li class="L5"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df_new</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">)</span></code></li><li class="L6"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df_new</span><span class="pun">.</span><span class="pln">iloc</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">5</span><span class="pun">,:])</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">df_new</span><span class="pun">.</span><span class="pln">to_csv</span><span class="pun">(</span><span class="str">'GSE102720_diff_polarity_dataframe.txt'</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">index</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="kg5k"><strong>Finally, the difference of polarity scores from all datasets were merged. Please refer to <a href="https://github.com/sherkinglee/RocA/blob/main/data/total_merged_diff_polarity_202102.txt" target="_blank">total_merged_diff_polarity_202102.txt</a>.</strong></p><div class="md-section-divider"></div><h2 data-anchor-id="az8d" id="calculate-rpkm-for-each-datasets"><strong>Calculate RPKM for each datasets</strong></h2><ul data-anchor-id="kx15">
<li>use <a href="https://github.com/sherkinglee/RocA/blob/main/metadata/GSE102720_configure.txt" target="_blank">GSE102720</a> for example.</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rdex"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE102720_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'Naive-DMSO,Naive-RocA03,Aglaiacized-DMSO,Aglaiacized-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'Naive-DMSO-1,Naive-DMSO-2__Naive-RocA03__Aglaiacized-DMSO-1,Aglaiacized-DMSO-2__Aglaiacized-RocA03'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $workdir</span><span class="pun">/</span><span class="pln">RPKM</span></code></li><li class="L1"><code><span class="pln">python RPKM</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="pln">RPKM</span><span class="pun">/</span><span class="pln">MA  </span><span class="pun">--</span><span class="pln">type CDS </span><span class="com">## calculate RPKM of each longest transcript</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">RPKMmean</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i $workdir</span><span class="pun">/</span><span class="pln">RPKM</span><span class="pun">/</span><span class="pln">MA_RPKM_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="pln">RPKM</span><span class="pun">/</span><span class="pln">MA </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="com">## calculate mean RPKM for the replicates</span></code></li></ol></pre><ul data-anchor-id="kscc">
<li>Calculate the log2FC(RPKM) for each transcript</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="6f51"><ol class="linenums"><li class="L0"><code><span class="kwd">import</span><span class="pln"> pandas </span><span class="kwd">as</span><span class="pln"> pd</span></code></li><li class="L1"><code><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L2"><code><span class="pln">df</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="pln">read_csv</span><span class="pun">(</span><span class="str">'MA_mean_RPKM_dataframe.txt'</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">)</span></code></li><li class="L3"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">)</span></code></li><li class="L4"><code><span class="com">##19636,5</span></code></li><li class="L5"><code><span class="pln">m</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">df</span><span class="pun">.</span><span class="pln">shape</span></code></li><li class="L6"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">iloc</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">5</span><span class="pun">,</span><span class="lit">0</span><span class="pun">:(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)])</span></code></li><li class="L7"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">columns</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">df</span><span class="pun">.</span><span class="pln">rename</span><span class="pun">(</span><span class="pln">columns</span><span class="pun">={</span><span class="str">'Unnamed: 0'</span><span class="pun">:</span><span class="str">'transcript_id'</span><span class="pun">},</span><span class="pln"> inplace </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span></code></li><li class="L9"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">.</span><span class="pln">columns</span><span class="pun">)</span></code></li><li class="L0"><code><span class="pln">df</span><span class="pun">[</span><span class="str">'Naive-RocA03-DMSO(GSE102720)'</span><span class="pun">]=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">log2</span><span class="pun">(</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Naive-RocA03'</span><span class="pun">]/</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Naive-DMSO'</span><span class="pun">])</span></code></li><li class="L1"><code><span class="pln">df</span><span class="pun">[</span><span class="str">'Aglaiacized-RocA03-DMSO(GSE102720)'</span><span class="pun">]=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">log2</span><span class="pun">(</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Aglaiacized-RocA03'</span><span class="pun">]/</span><span class="pln">df</span><span class="pun">[</span><span class="str">'Aglaiacized-DMSO'</span><span class="pun">])</span></code></li><li class="L2"><code><span class="pln">df_new</span><span class="pun">=</span><span class="pln">df</span><span class="pun">[[</span><span class="str">'transcript_id'</span><span class="pun">,</span><span class="str">'Naive-RocA03-DMSO(GSE102720)'</span><span class="pun">,</span><span class="str">'Aglaiacized-RocA03-DMSO(GSE102720)'</span><span class="pun">]]</span></code></li><li class="L3"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df_new</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">)</span></code></li><li class="L4"><code><span class="kwd">print</span><span class="pun">(</span><span class="pln">df_new</span><span class="pun">.</span><span class="pln">iloc</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">5</span><span class="pun">,:])</span></code></li><li class="L5"><code><span class="pln">df_new</span><span class="pun">.</span><span class="pln">to_csv</span><span class="pun">(</span><span class="str">'GSE102720_diff_RPKM_dataframe.txt'</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">index</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="wqd0"><strong>Finally, the RPKM of all transcripts from all datasets were merged. Please refer to <a href="https://github.com/sherkinglee/RocA/blob/main/data/total_merged_cds_level_RPKM_202102.txt" target="_blank">total_merged_cds_level_RPKM_202102.txt</a>.</strong></p><div class="md-section-divider"></div><h2 data-anchor-id="92ht" id="calculate-coverage-for-each-datasets"><strong>Calculate Coverage for each datasets</strong></h2><ul data-anchor-id="qivc">
<li>Calculate coverage using <a href="https://github.com/xryanglab/RiboMiner" target="_blank"><strong>RiboMiner</strong></a>, use <a href="https://github.com/sherkinglee/RocA/blob/main/metadata/GSE102720_configure.txt" target="_blank">GSE102720</a> for example. </li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3ok3"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE102720_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'Naive-DMSO,Naive-RocA03,Aglaiacized-DMSO,Aglaiacized-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'Naive-DMSO-1,Naive-DMSO-2__Naive-RocA03__Aglaiacized-DMSO-1,Aglaiacized-DMSO-2__Aglaiacized-RocA03'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com">## coverage</span></code></li><li class="L1"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $workdir</span><span class="pun">/</span><span class="pln">coverage</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="typ">RiboDensityAtEachPosition</span><span class="pln"> </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="pln">coverage</span><span class="pun">/</span><span class="pln">MA  </span><span class="pun">-</span><span class="pln">U codon</span></code></li></ol></pre><p data-anchor-id="fvod"><strong>Finally, the coverage of all transcripts from all datasets were merged. Please refer to <a href="https://github.com/sherkinglee/RocA/blob/main/data/total_merged_read_coverage_202102.txt" target="_blank">total_merged_read_coverage_202102.txt</a>.</strong></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="h4f5" id="re-generation-of-the-results-presented-in-the-manuscript"><strong>Re-generation of the results presented in the manuscript</strong></h2><div class="md-section-divider"></div><h3 data-anchor-id="41td" id="figure-1a"><strong>Figure 1A</strong></h3><ul data-anchor-id="bdvf">
<li>all used data were deposited in <a href="https://github.com/sherkinglee/RocA/blob/main/data/" target="_blank">./data</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="hmat"><ol class="linenums"><li class="L0"><code><span class="typ">TranslationRelatedConsitionPairs</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">total_merged_cds_level_RPKM_202102</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">total_merged_diff_polarity_202102</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">total_merged_read_coverage_202102</span><span class="pun">.</span><span class="pln">txt</span></code></li></ol></pre><ul data-anchor-id="5jvp">
<li>clustering analyses via <a href="https://github.com/sherkinglee/RocA/blob/main/script/RiboPipe.py" target="_blank">RiboPipe.py</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="cuwm"><ol class="linenums"><li class="L0"><code><span class="com">#!/usr/bin/env python</span></code></li><li class="L1"><code><span class="com"># -*- coding:UTF-8 -*-</span></code></li><li class="L2"><code><span class="str">'''</span></code></li><li class="L3"><code><span class="str">Author: Li Fajin</span></code></li><li class="L4"><code><span class="str">Date: 2021-02-15 13:23:59</span></code></li><li class="L5"><code><span class="str">LastEditors: Li Fajin</span></code></li><li class="L6"><code><span class="str">LastEditTime: 2022-05-28 12:21:37</span></code></li><li class="L7"><code><span class="str">Description: file content</span></code></li><li class="L8"><code><span class="str">'''</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="kwd">import</span><span class="pln"> pandas </span><span class="kwd">as</span><span class="pln"> pd</span></code></li><li class="L1"><code><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L2"><code><span class="kwd">import</span><span class="pln"> matplotlib</span></code></li><li class="L3"><code><span class="pln">matplotlib</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="str">'Agg'</span><span class="pun">)</span></code></li><li class="L4"><code><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt</span></code></li><li class="L5"><code><span class="kwd">import</span><span class="pln"> seaborn </span><span class="kwd">as</span><span class="pln"> sns</span></code></li><li class="L6"><code><span class="kwd">import</span><span class="pln"> os</span></code></li><li class="L7"><code></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="str">'''</span></code></li><li class="L0"><code><span class="str">###################################</span></code></li><li class="L1"><code><span class="str">Date: 20220528.15:00</span></code></li><li class="L2"><code><span class="str">all polarity with Tranlation initiation and elongation</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="str">19636 trans x 49 conditionPairs</span></code></li><li class="L5"><code><span class="str">###################################</span></code></li><li class="L6"><code><span class="str">'''</span></code></li><li class="L7"><code><span class="typ">ConditionPairs_of_initiation_and_elongation</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="pln">read_csv</span><span class="pun">(</span><span class="str">"../data/TranslationRelatedConsitionPairs.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">polarity_with_initiation_and_elongation</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="pln">read_csv</span><span class="pun">(</span><span class="str">"../data/total_merged_diff_polarity_202102.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">index_col</span><span class="pun">=</span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">RPKM_with_initiation_and_elongation</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="pln">read_csv</span><span class="pun">(</span><span class="str">"../data/total_merged_cds_level_RPKM_202102.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">index_col</span><span class="pun">=</span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L0"><code><span class="pln">RPKM_with_initiation_and_elongation</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">).</span><span class="pln">describe</span><span class="pun">()</span><span class="pln"> </span><span class="com">## trans describe</span></code></li><li class="L1"><code><span class="pln">RPKM_with_initiation_and_elongation</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=</span><span class="lit">0</span><span class="pun">).</span><span class="pln">describe</span><span class="pun">()</span><span class="pln"> </span><span class="com">## sample describe</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">coverage_with_initiation_and_elongation</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="pln">read_csv</span><span class="pun">(</span><span class="str">"../data/total_merged_read_coverage_202102.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">index_col</span><span class="pun">=</span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">coverage_with_initiation_and_elongation_sorted</span><span class="pun">=</span><span class="pln">coverage_with_initiation_and_elongation</span><span class="pun">[</span><span class="pln">sorted</span><span class="pun">(</span><span class="pln">coverage_with_initiation_and_elongation</span><span class="pun">.</span><span class="pln">columns</span><span class="pun">)]</span></code></li><li class="L5"><code><span class="pln">coverage_with_initiation_and_elongation_sorted</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">).</span><span class="pln">describe</span><span class="pun">()</span><span class="pln"> </span><span class="com">## trans describe</span></code></li><li class="L6"><code><span class="pln">coverage_with_initiation_and_elongation_sorted</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=</span><span class="lit">0</span><span class="pun">).</span><span class="pln">describe</span><span class="pun">()</span><span class="pln"> </span><span class="com">## sample describe</span></code></li><li class="L7"><code></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">RPKM_with_initiation_and_elongation_filtered_gt0_in_each_samples</span><span class="pun">=</span><span class="pln">RPKM_with_initiation_and_elongation</span><span class="pun">.</span><span class="pln">loc</span><span class="pun">[</span><span class="pln">RPKM_with_initiation_and_elongation</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">min</span><span class="pun">,</span><span class="pln">axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)&gt;=</span><span class="lit">1</span><span class="pun">,:]</span></code></li><li class="L0"><code><span class="pln">coverage_with_initiation_and_elongation_filtered_mean_of_each_trans_gt_pectMean</span><span class="pun">=</span><span class="pln">coverage_with_initiation_and_elongation_sorted</span><span class="pun">.</span><span class="pln">loc</span><span class="pun">[</span><span class="pln">coverage_with_initiation_and_elongation_sorted</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">,</span><span class="pln">axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)&gt;=</span><span class="pln">coverage_with_initiation_and_elongation_sorted</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">,</span><span class="pln">axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">).</span><span class="pln">describe</span><span class="pun">()[</span><span class="str">'mean'</span><span class="pun">],:]</span></code></li><li class="L1"><code><span class="pln">trans_in_common_associated_with_translation</span><span class="pun">=</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">RPKM_with_initiation_and_elongation_filtered_gt0_in_each_samples</span><span class="pun">.</span><span class="pln">index</span><span class="pun">).</span><span class="pln">intersection</span><span class="pun">(</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">coverage_with_initiation_and_elongation_filtered_mean_of_each_trans_gt_pectMean</span><span class="pun">.</span><span class="pln">index</span><span class="pun">))</span></code></li><li class="L2"><code><span class="pln">polarity_with_initiation_and_elongation_filtered</span><span class="pun">=</span><span class="pln">polarity_with_initiation_and_elongation</span><span class="pun">.</span><span class="pln">loc</span><span class="pun">[</span><span class="pln">trans_in_common_associated_with_translation</span><span class="pun">,:]</span></code></li><li class="L3"><code></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">polarity_with_initiation_and_elongation_filtered_vars</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="kwd">var</span><span class="pun">(</span><span class="pln">polarity_with_initiation_and_elongation_filtered</span><span class="pun">,</span><span class="pln">axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">polarity_with_initiation_and_elongation_filtered_vars</span><span class="pun">.</span><span class="pln">describe</span><span class="pun">()</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">trans_filtered_by_polarityVars</span><span class="pun">=</span><span class="pln">polarity_with_initiation_and_elongation_filtered</span><span class="pun">.</span><span class="pln">iloc</span><span class="pun">[</span><span class="pln">np</span><span class="pun">.</span><span class="kwd">where</span><span class="pun">(</span><span class="pln">polarity_with_initiation_and_elongation_filtered_vars</span><span class="pun">&gt;</span><span class="pln">polarity_with_initiation_and_elongation_filtered_vars</span><span class="pun">.</span><span class="pln">describe</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">polarity_with_initiation_and_elongation_filtered_vars</span><span class="pun">.</span><span class="pln">describe</span><span class="pun">()[</span><span class="lit">2</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">],:]</span></code></li><li class="L9"><code><span class="pln">polarity_with_initiation_and_elongation_filtered_filtered_byPolarityVars</span><span class="pun">=</span><span class="pln">polarity_with_initiation_and_elongation_filtered</span><span class="pun">.</span><span class="pln">drop</span><span class="pun">(</span><span class="pln">trans_filtered_by_polarityVars</span><span class="pun">.</span><span class="pln">index</span><span class="pun">)</span></code></li><li class="L0"><code></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">plt</span><span class="pun">.</span><span class="pln">rc</span><span class="pun">(</span><span class="str">'font'</span><span class="pun">,</span><span class="pln">weight</span><span class="pun">=</span><span class="str">'bold'</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">sns</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">font_scale</span><span class="pun">=</span><span class="lit">0.5</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">fig</span><span class="pun">=</span><span class="pln">plt</span><span class="pun">.</span><span class="pln">figure</span><span class="pun">()</span></code></li><li class="L5"><code><span class="pln">col_c</span><span class="pun">=</span><span class="pln">dict</span><span class="pun">(</span><span class="pln">zip</span><span class="pun">(</span><span class="typ">ConditionPairs_of_initiation_and_elongation</span><span class="pun">[</span><span class="str">'TranslationType'</span><span class="pun">].</span><span class="pln">unique</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">[</span><span class="str">'#2a93d4'</span><span class="pun">,</span><span class="str">'#ffb5ba'</span><span class="pun">,</span><span class="str">'#79bd9a'</span><span class="pun">]))</span></code></li><li class="L6"><code><span class="pln">col_colors</span><span class="pun">=</span><span class="typ">ConditionPairs_of_initiation_and_elongation</span><span class="pun">[</span><span class="str">'TranslationType'</span><span class="pun">].</span><span class="pln">map</span><span class="pun">(</span><span class="pln">col_c</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">ax</span><span class="pun">=</span><span class="pln">sns</span><span class="pun">.</span><span class="pln">clustermap</span><span class="pun">(</span><span class="pln">polarity_with_initiation_and_elongation_filtered_filtered_byPolarityVars</span><span class="pun">,</span><span class="pln">method </span><span class="pun">=</span><span class="str">'ward'</span><span class="pun">,</span><span class="pln">metric</span><span class="pun">=</span><span class="str">'euclidean'</span><span class="pun">,</span><span class="pln">row_cluster</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln">col_cluster</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span></code></li><li class="L8"><code><span class="pln">                vmin</span><span class="pun">=-</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln">vmax</span><span class="pun">=</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln">center</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">cmap </span><span class="pun">=</span><span class="pln"> </span><span class="str">'RdBu_r'</span><span class="pun">,</span><span class="pln">col_colors</span><span class="pun">=</span><span class="pln">col_colors</span><span class="pun">.</span><span class="pln">values</span><span class="pun">,</span><span class="pln">yticklabels</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">xticklabels</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">ax</span><span class="pun">.</span><span class="pln">cax</span><span class="pun">.</span><span class="pln">set_visible</span><span class="pun">(</span><span class="kwd">False</span><span class="pun">)</span></code></li><li class="L0"><code><span class="pln">plt</span><span class="pun">.</span><span class="pln">savefig</span><span class="pun">(</span><span class="str">"../results/Figure 1A.pdf"</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="ztfd"><img src="http://static.zybuluo.com/sherking/d63qt5r9rjosqwacm9rbbn1w/image_1g44efhhh1dc21qhi1heo16dbhim9.png" alt="image_1g44efhhh1dc21qhi1heo16dbhim9.png-187.5kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="nkit" id="figure-1b"><strong>Figure 1B</strong></h3><ul data-anchor-id="66xz">
<li>set <a href="https://github.com/sherkinglee/RocA/blob/main/metadata/GSE70211_configure.txt" target="_blank">configure</a> file</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2ohe"><ol class="linenums"><li class="L0"><code><span class="pln">bamFiles    readLengths </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L1"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR2075925_STAR</span><span class="pun">/</span><span class="pln">SRR2075925</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pln"> </span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pln"> DMSO</span><span class="pun">-</span><span class="lit">1</span></code></li><li class="L2"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR2075926_STAR</span><span class="pun">/</span><span class="pln">SRR2075926</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pln">  </span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">12</span><span class="pln">  DMSO</span><span class="pun">-</span><span class="lit">2</span></code></li><li class="L3"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR2075927_STAR</span><span class="pun">/</span><span class="pln">SRR2075927</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pln">  </span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">12</span><span class="pln">  </span><span class="typ">RocA</span><span class="pun">-</span><span class="lit">003</span></code></li><li class="L4"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR2075928_STAR</span><span class="pun">/</span><span class="pln">SRR2075928</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">24</span><span class="pun">,</span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pln">   </span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pln">   </span><span class="typ">RocA</span><span class="pun">-</span><span class="lit">03</span></code></li><li class="L5"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR2075929_STAR</span><span class="pun">/</span><span class="pln">SRR2075929</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam    </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pln"> </span><span class="lit">11</span><span class="pun">,</span><span class="lit">11</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pln"> </span><span class="typ">RocA</span><span class="pun">-</span><span class="lit">3</span></code></li></ol></pre><p data-anchor-id="rx36">All the bam files were generated via the <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/Ribo-seq-snakemake.py" target="_blank">Ribo-seq analyses pipeline</a>.</p><ul data-anchor-id="f6j8">
<li>Metagene via <a href="https://github.com/xryanglab/RiboMiner" target="_blank">RiboMiner</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="9csa"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE70211_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO,RocA003,RocA03,RocA3'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1,DMSO-2__RocA-003__RocA-03__RocA-3'</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">10</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">1</span><span class="pln">  </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span></code></li><li class="L2"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><p data-anchor-id="i8di"><img src="http://static.zybuluo.com/sherking/3moovmbrindxz1f5m600uncn/image_1g44f9obfic6l90pvp86nntm.png" alt="image_1g44f9obfic6l90pvp86nntm.png-93.6kB" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="qe5a" id="figure-1c"><strong>Figure 1C</strong></h3><ul data-anchor-id="suo8">
<li>Calculate codon density for each sample</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7mcv"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE70211_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO,RocA003,RocA03,RocA3'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1,DMSO-2__RocA-003__RocA-03__RocA-3'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="typ">RiboDensityAtEachPosition</span><span class="pln"> </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="pln">coverage</span><span class="pun">/</span><span class="pln">MA  </span><span class="pun">-</span><span class="pln">U codon</span></code></li></ol></pre><ul data-anchor-id="7r92">
<li>Statistic read density at the first 75 codons via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/ProcessCodonDensityAtEachPosition.py" target="_blank">ProcessCodonDensityAtEachPosition.py</a> script.</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xpmz"><ol class="linenums"><li class="L0"><code><span class="com">## the first 75    </span></code></li><li class="L1"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">75</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o DMSO_1_first75</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">75</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o DMSO_2_first75</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">75</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_first75</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">75</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_first75</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">75</span><span class="pln"> </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_first75</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="com">## all CDS</span></code></li><li class="L8"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">-</span><span class="pln">o DMSO_1_all</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">-</span><span class="pln">o DMSO_2_all</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_all</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_all</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">$ python </span><span class="typ">ProcessCodonDensityAtEachPosition</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i MA_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_cds_codon_density</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_all</span><span class="pun">.</span><span class="pln">txt</span></code></li></ol></pre><ul data-anchor-id="qprc">
<li>Statistics of ratio of the first 75 codons vs the whole CDS region,via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/RiboDensityAtEachPosition.Rmd" target="_blank">RiboDensityAtEachPosition.Rmd</a>.</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="4fmp"><ol class="linenums"><li class="L0"><code><span class="com">## Open Rstudio and do it in R platform</span></code></li><li class="L1"><code><span class="pln">rm</span><span class="pun">(</span><span class="pln">list</span><span class="pun">=</span><span class="pln">ls</span><span class="pun">())</span></code></li><li class="L2"><code><span class="pln">setwd</span><span class="pun">(</span><span class="str">'../data'</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">human_info </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"Homo_sapiens.GRCh38.88.transInfo.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">check</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">)</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="com">## all counts</span></code></li><li class="L6"><code><span class="pln">DMSO_1_all_counts </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"DMSO_1_all.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">DMSO_2_all_counts </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"DMSO_2_all.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L8"><code><span class="typ">RocA003_all_counts</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RocA003_all.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L9"><code><span class="typ">RocA03_all_counts</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RocA03_all.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L0"><code><span class="typ">RocA3_all_counts</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RocA3_all.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="com">## first 75 codons</span></code></li><li class="L3"><code><span class="pln">DMSO_1_first75 </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"DMSO_1_first75.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">DMSO_2_first75 </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"DMSO_2_first75.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L5"><code><span class="typ">RocA003_first75</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RocA003_first75.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L6"><code><span class="typ">RocA03_first75</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RocA03_first75.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L7"><code><span class="typ">RocA3_first75</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RocA3_first75.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="com">## all counts</span></code></li><li class="L0"><code><span class="pln">DMSO_1_factor </span><span class="pun">&lt;-</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">DMSO_1_all_counts$counts</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">DMSO_2_factor </span><span class="pun">&lt;-</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">DMSO_2_all_counts$counts</span><span class="pun">)</span></code></li><li class="L2"><code><span class="typ">RocA003_factor</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> sum</span><span class="pun">(</span><span class="typ">RocA003_all_counts$counts</span><span class="pun">)</span></code></li><li class="L3"><code><span class="typ">RocA03_factor</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> sum</span><span class="pun">(</span><span class="typ">RocA03_all_counts$counts</span><span class="pun">)</span></code></li><li class="L4"><code><span class="typ">RocA3_factor</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> sum</span><span class="pun">(</span><span class="typ">RocA3_all_counts$counts</span><span class="pun">)</span></code></li><li class="L5"><code></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="com">## normalized</span></code></li><li class="L8"><code><span class="pln">DMSO_1_all_counts</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="pln">DMSO_1_all_counts</span><span class="pun">/</span><span class="pln">DMSO_1_factor</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">DMSO_2_all_counts</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="pln">DMSO_2_all_counts</span><span class="pun">/</span><span class="pln">DMSO_2_factor</span><span class="pun">)</span></code></li><li class="L0"><code><span class="typ">RocA003_all_counts</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="typ">RocA003_all_counts</span><span class="pun">/</span><span class="typ">RocA003_factor</span><span class="pun">)</span></code></li><li class="L1"><code><span class="typ">RocA03_all_counts</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="typ">RocA03_all_counts</span><span class="pun">/</span><span class="typ">RocA03_factor</span><span class="pun">)</span></code></li><li class="L2"><code><span class="typ">RocA3_all_counts</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="typ">RocA3_all_counts</span><span class="pun">/</span><span class="typ">RocA3_factor</span><span class="pun">)</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">DMSO_1_first75</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="pln">DMSO_1_first75</span><span class="pun">/</span><span class="pln">DMSO_1_factor</span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln">DMSO_2_first75</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="pln">DMSO_2_first75</span><span class="pun">/</span><span class="pln">DMSO_2_factor</span><span class="pun">)</span></code></li><li class="L6"><code><span class="typ">RocA003_first75</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="typ">RocA003_first75</span><span class="pun">/</span><span class="typ">RocA003_factor</span><span class="pun">)</span></code></li><li class="L7"><code><span class="typ">RocA03_first75</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="typ">RocA03_first75</span><span class="pun">/</span><span class="typ">RocA03_factor</span><span class="pun">)</span></code></li><li class="L8"><code><span class="typ">RocA3_first75</span><span class="pun">[</span><span class="str">'RPM'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="lit">10</span><span class="pun">^</span><span class="lit">6</span><span class="pun">*(</span><span class="typ">RocA3_first75</span><span class="pun">/</span><span class="typ">RocA3_factor</span><span class="pun">)</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com">## mean value of DMSO</span></code></li><li class="L1"><code><span class="pln">DMSO_all_counts </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DMSO_1_all_counts</span><span class="pun">+</span><span class="pln">DMSO_2_all_counts</span><span class="pun">)/</span><span class="lit">2</span></code></li><li class="L2"><code><span class="pln">DMSO_first75 </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DMSO_1_first75</span><span class="pun">+</span><span class="pln">DMSO_2_first75</span><span class="pun">)/</span><span class="lit">2</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">## construct dataframe</span></code></li><li class="L5"><code><span class="pln">all_RPM </span><span class="pun">&lt;-</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">DMSO</span><span class="pun">=</span><span class="pln">DMSO_all_counts$RPM</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">=</span><span class="typ">RocA003_all_counts$RPM</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">=</span><span class="typ">RocA03_all_counts$RPM</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">=</span><span class="typ">RocA3_all_counts$RPM</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">rownames</span><span class="pun">(</span><span class="pln">all_RPM</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> rownames</span><span class="pun">(</span><span class="typ">RocA003_all_counts</span><span class="pun">)</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">first75_RPM </span><span class="pun">&lt;-</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">DMSO</span><span class="pun">=</span><span class="pln">DMSO_first75$RPM</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">=</span><span class="typ">RocA003_first75$RPM</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">=</span><span class="typ">RocA03_first75$RPM</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">=</span><span class="typ">RocA3_first75$RPM</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">rownames</span><span class="pun">(</span><span class="pln">first75_RPM</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> rownames</span><span class="pun">(</span><span class="typ">RocA003_all_counts</span><span class="pun">)</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">after75_RPM </span><span class="pun">&lt;-</span><span class="pln"> all_RPM</span><span class="pun">-</span><span class="pln">first75_RPM</span></code></li><li class="L2"><code></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">## select common transcript used for analysis, all_CDS_unnormed_transcript_id.txt generated by Figure 1B results.</span></code></li><li class="L5"><code><span class="pln">filtered_trans </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"all_CDS_unnormed_transcript_id.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">common_trans </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="typ">Reduce</span><span class="pun">(</span><span class="pln">intersect</span><span class="pun">,</span><span class="pln">filtered_trans</span><span class="pun">)</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">all_RPM_common </span><span class="pun">&lt;-</span><span class="pln"> all_RPM</span><span class="pun">[</span><span class="pln">common_trans</span><span class="pun">,]</span></code></li><li class="L9"><code><span class="pln">first75_RPM_common </span><span class="pun">&lt;-</span><span class="pln"> first75_RPM</span><span class="pun">[</span><span class="pln">common_trans</span><span class="pun">,]</span></code></li><li class="L0"><code><span class="pln">after75_RPM_common </span><span class="pun">&lt;-</span><span class="pln"> after75_RPM</span><span class="pun">[</span><span class="pln">common_trans</span><span class="pun">,]</span></code></li><li class="L1"><code></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="com">## visulization</span></code></li><li class="L4"><code><span class="pln">library</span><span class="pun">(</span><span class="pln">ggpubr</span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln">library</span><span class="pun">(</span><span class="pln">reshape2</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">library</span><span class="pun">(</span><span class="kwd">export</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">ratio_reshaped </span><span class="pun">&lt;-</span><span class="pln"> melt</span><span class="pun">(</span><span class="pln">ratio</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">p</span><span class="pun">&lt;-</span><span class="pln">ggboxplot</span><span class="pun">(</span><span class="pln">ratio_reshaped</span><span class="pun">,</span><span class="pln">x</span><span class="pun">=</span><span class="str">"variable"</span><span class="pun">,</span><span class="pln">y</span><span class="pun">=</span><span class="str">"value"</span><span class="pun">,</span><span class="pln">fill</span><span class="pun">=</span><span class="str">"variable"</span><span class="pun">,</span><span class="pln">palette </span><span class="pun">=</span><span class="pln"> </span><span class="str">"npg"</span><span class="pun">,</span><span class="pln">xlab </span><span class="pun">=</span><span class="pln"> FALSE</span><span class="pun">,</span><span class="pln">ylab </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Counts ratio of the first 75 codons"</span><span class="pun">,</span><span class="pln">size</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">font</span><span class="pun">.</span><span class="pln">label </span><span class="pun">=</span><span class="pln"> </span><span class="lit">16</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">pp </span><span class="pun">&lt;-</span><span class="pln"> ggpar</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln">legend </span><span class="pun">=</span><span class="pln"> </span><span class="str">"right"</span><span class="pun">,</span><span class="pln">legend</span><span class="pun">.</span><span class="pln">title </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Samples"</span><span class="pun">)</span></code></li><li class="L0"><code><span class="pln">pp</span></code></li><li class="L1"><code><span class="pln">graph2ppt</span><span class="pun">(</span><span class="pln">x</span><span class="pun">=</span><span class="pln">pp</span><span class="pun">,</span><span class="str">"../results/Figure 1C.ppt"</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="gr5c"><img src="http://static.zybuluo.com/sherking/n0y81lkomzlnawrjrpyd069r/image_1g44fv5tb13vplc61kcunbb17t513.png" alt="image_1g44fv5tb13vplc61kcunbb17t513.png-20.8kB" title="">  </p><div class="md-section-divider"></div><h3 data-anchor-id="eohd" id="figure-1d"><strong>Figure 1D</strong></h3><ul data-anchor-id="krox">
<li>DE analysis via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/DESeq2.R" target="_blank">DEseq2.R</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="84cz"><ol class="linenums"><li class="L0"><code><span class="pln">setwd</span><span class="pun">(</span><span class="str">"../data"</span><span class="pun">)</span></code></li><li class="L1"><code><span class="com">## read data</span></code></li><li class="L2"><code><span class="pln">RNA </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RNA.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">check</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">rownames</span><span class="pun">(</span><span class="pln">RNA</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> RNA$gene_id</span></code></li><li class="L4"><code><span class="pln">RNA </span><span class="pun">&lt;-</span><span class="pln"> RNA</span><span class="pun">[,-</span><span class="lit">1</span><span class="pun">]</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">RPF </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"RPF.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">check</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">rownames</span><span class="pun">(</span><span class="pln">RPF</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> RPF$gene_id</span></code></li><li class="L8"><code><span class="pln">RPF </span><span class="pun">&lt;-</span><span class="pln"> RPF</span><span class="pun">[,-</span><span class="lit">1</span><span class="pun">]</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">human_info </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"Homo_sapiens.GRCh38.88.transInfo.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">check</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">longest_info </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"longest.transcripts.info.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">check</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">common_gene_id </span><span class="pun">&lt;-</span><span class="pln"> intersect</span><span class="pun">(</span><span class="pln">rownames</span><span class="pun">(</span><span class="pln">RPF</span><span class="pun">),</span><span class="pln">rownames</span><span class="pun">(</span><span class="pln">RNA</span><span class="pun">))</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">RNA_common </span><span class="pun">&lt;-</span><span class="pln"> RNA</span><span class="pun">[</span><span class="pln">common_gene_id</span><span class="pun">,]</span></code></li><li class="L6"><code><span class="pln">RPF_common </span><span class="pun">&lt;-</span><span class="pln"> RPF</span><span class="pun">[</span><span class="pln">common_gene_id</span><span class="pun">,]</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">common_gene_info </span><span class="pun">&lt;-</span><span class="pln"> human_info</span><span class="pun">[</span><span class="pln">which</span><span class="pun">(</span><span class="pln">human_info$gene_id</span><span class="pun">%</span><span class="kwd">in</span><span class="pun">%</span><span class="pln">common_gene_id</span><span class="pun">),]</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com">## DE</span></code></li><li class="L1"><code><span class="pln">library</span><span class="pun">(</span><span class="typ">DESeq2</span><span class="pun">)</span></code></li><li class="L2"><code><span class="typ">RocA03_RPF</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> RPF</span><span class="pun">[,</span><span class="pln">c</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">4</span><span class="pun">)]</span></code></li><li class="L3"><code><span class="pln">indice </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="typ">Reduce</span><span class="pun">(</span><span class="pln">intersect</span><span class="pun">,</span><span class="pln">lapply</span><span class="pun">(</span><span class="typ">RocA03_RPF</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">x</span><span class="pun">){</span><span class="pln">which</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;=</span><span class="lit">10</span><span class="pun">)}))</span></code></li><li class="L4"><code><span class="pln">RPF_filtered </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="typ">RocA03_RPF</span><span class="pun">[</span><span class="pln">indice</span><span class="pun">,]</span></code></li><li class="L5"><code><span class="pln">RPF_filtered_DESeq2 </span><span class="pun">&lt;-</span><span class="pln"> RPF_filtered</span></code></li><li class="L6"><code><span class="com"># construct sample information</span></code></li><li class="L7"><code><span class="pln">colData </span><span class="pun">&lt;-</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">sample</span><span class="pun">=</span><span class="pln">colnames</span><span class="pun">(</span><span class="pln">RPF_filtered_DESeq2</span><span class="pun">),</span><span class="pln">condition</span><span class="pun">=</span><span class="pln">rep</span><span class="pun">(</span><span class="pln">c</span><span class="pun">(</span><span class="str">"DMSO"</span><span class="pun">,</span><span class="str">"RocA03"</span><span class="pun">),</span><span class="pln">times</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)))</span></code></li><li class="L8"><code><span class="pln">rownames</span><span class="pun">(</span><span class="pln">colData</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="kwd">as</span><span class="pun">.</span><span class="pln">character</span><span class="pun">(</span><span class="pln">colData$sample</span><span class="pun">)</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com"># construct DESeq dataset</span></code></li><li class="L1"><code><span class="pln">dds </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="typ">DESeqDataSetFromMatrix</span><span class="pun">(</span><span class="pln">countData </span><span class="pun">=</span><span class="pln"> RPF_filtered_DESeq2</span><span class="pun">,</span><span class="pln">colData </span><span class="pun">=</span><span class="pln"> colData</span><span class="pun">,</span><span class="pln">design </span><span class="pun">=</span><span class="pln"> </span><span class="pun">~</span><span class="pln">condition</span><span class="pun">)</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="com"># normalization</span></code></li><li class="L4"><code><span class="pln">dds </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="typ">DESeq</span><span class="pun">(</span><span class="pln">dds</span><span class="pun">)</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="com"># get the results</span></code></li><li class="L7"><code><span class="pln">res </span><span class="pun">&lt;-</span><span class="pln"> results</span><span class="pun">(</span><span class="pln">dds</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">summary</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">head</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="com"># get differential expression genes</span></code></li><li class="L2"><code><span class="pln">table</span><span class="pun">(</span><span class="pln">res$padj</span><span class="pun">&lt;</span><span class="lit">0.05</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">res </span><span class="pun">&lt;-</span><span class="pln"> res</span><span class="pun">[</span><span class="pln">order</span><span class="pun">(</span><span class="pln">res$padj</span><span class="pun">),]</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">DE_genes_table </span><span class="pun">&lt;-</span><span class="pln"> subset</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln">padj </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0.05</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">log2FoldChange</span><span class="pun">)&gt;=</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">DE_genes_table</span><span class="pun">,</span><span class="str">"DE_genes_table.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">quote </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> TRUE</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> TRUE</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">DE_genes </span><span class="pun">&lt;-</span><span class="pln"> rownames</span><span class="pun">(</span><span class="pln">DE_genes_table</span><span class="pun">)</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="com"># get expression matrix of DE genes(normalized) and counts</span></code></li><li class="L0"><code><span class="pln">DE_genes_counts_normalized </span><span class="pun">&lt;-</span><span class="pln"> counts</span><span class="pun">(</span><span class="pln">dds</span><span class="pun">,</span><span class="pln">normalize</span><span class="pun">=</span><span class="pln">TRUE</span><span class="pun">)[</span><span class="pln">DE_genes</span><span class="pun">,]</span></code></li><li class="L1"><code><span class="pln">DE_genes_counts </span><span class="pun">&lt;-</span><span class="pln"> RPF_filtered_DESeq2</span><span class="pun">[</span><span class="pln">DE_genes</span><span class="pun">,]</span></code></li><li class="L2"><code><span class="pln">up_genes_res </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="kwd">as</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">subset</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln">padj</span><span class="pun">&lt;=</span><span class="lit">0.05</span><span class="pun">&amp;</span><span class="pln">log2FoldChange</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">))</span></code></li><li class="L3"><code><span class="pln">down_genes_res </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="kwd">as</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">subset</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln">padj</span><span class="pun">&lt;=</span><span class="lit">0.05</span><span class="pun">&amp;</span><span class="pln">log2FoldChange</span><span class="pun">&lt;=-</span><span class="lit">1</span><span class="pun">))</span></code></li><li class="L4"><code><span class="typ">Unchanged_genes_res</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="kwd">as</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)[</span><span class="pln">setdiff</span><span class="pun">(</span><span class="pln">res@rownames</span><span class="pun">,</span><span class="kwd">union</span><span class="pun">(</span><span class="pln">rownames</span><span class="pun">(</span><span class="pln">up_genes_res</span><span class="pun">),</span><span class="pln">rownames</span><span class="pun">(</span><span class="pln">down_genes_res</span><span class="pun">))),]</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">up_gene_info </span><span class="pun">&lt;-</span><span class="pln"> longest_info</span><span class="pun">[</span><span class="pln">match</span><span class="pun">(</span><span class="pln">rownames</span><span class="pun">(</span><span class="pln">up_genes_res</span><span class="pun">),</span><span class="pln">longest_info$gene_id</span><span class="pun">),]</span></code></li><li class="L7"><code><span class="pln">down_gene_info </span><span class="pun">&lt;-</span><span class="pln"> longest_info</span><span class="pun">[</span><span class="pln">match</span><span class="pun">(</span><span class="pln">rownames</span><span class="pun">(</span><span class="pln">down_genes_res</span><span class="pun">),</span><span class="pln">longest_info$gene_id</span><span class="pun">),]</span></code></li><li class="L8"><code><span class="pln">unchanged_gene_info </span><span class="pun">&lt;-</span><span class="pln"> longest_info</span><span class="pun">[</span><span class="pln">match</span><span class="pun">(</span><span class="pln">rownames</span><span class="pun">(</span><span class="typ">Unchanged_genes_res</span><span class="pun">),</span><span class="pln">longest_info$gene_id</span><span class="pun">),]</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">up_gene_info</span><span class="pun">,</span><span class="str">"374_up_genes_info.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">quote</span><span class="pun">=</span><span class="pln">F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">down_gene_info</span><span class="pun">,</span><span class="str">"643_down_genes_info.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">quote</span><span class="pun">=</span><span class="pln">F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L2"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">unchanged_gene_info</span><span class="pun">,</span><span class="str">"3918_unchanged_genes_info.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">quote</span><span class="pun">=</span><span class="pln">F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">up_genes_res</span><span class="pun">,</span><span class="str">"374_up_genes_data.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">quote</span><span class="pun">=</span><span class="pln">F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">down_genes_res</span><span class="pun">,</span><span class="str">"643_down_genes_data.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">quote</span><span class="pun">=</span><span class="pln">F</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li></ol></pre><ul data-anchor-id="166u">
<li>visualization</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="uuxz"><ol class="linenums"><li class="L0"><code><span class="com">## volcano plot using ggplot2</span></code></li><li class="L1"><code><span class="pln">log2FC </span><span class="pun">&lt;-</span><span class="pln"> res$log2FoldChange</span></code></li><li class="L2"><code><span class="pln">padjust </span><span class="pun">&lt;-</span><span class="pln"> res$padj</span></code></li><li class="L3"><code><span class="pln">data_for_plot </span><span class="pun">&lt;-</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">log2FC</span><span class="pun">=</span><span class="pln">log2FC</span><span class="pun">,</span><span class="pln">padjust</span><span class="pun">=</span><span class="pln">padjust</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">data_for_plot </span><span class="pun">&lt;-</span><span class="pln"> na</span><span class="pun">.</span><span class="pln">omit</span><span class="pun">(</span><span class="pln">data_for_plot</span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln">data_for_plot$sig</span><span class="pun">[(</span><span class="pln">data_for_plot$padjust</span><span class="pun">&gt;</span><span class="lit">0.05</span><span class="pun">|</span><span class="pln">data_for_plot$padjust</span><span class="pun">==</span><span class="str">"NA"</span><span class="pun">)|(</span><span class="pln">data_for_plot$log2FC</span><span class="pun">&gt;-</span><span class="lit">1</span><span class="pun">|</span><span class="pln">data_for_plot$log2FC</span><span class="pun">&lt;</span><span class="lit">1</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="str">"NO"</span></code></li><li class="L6"><code><span class="pln">data_for_plot$sig</span><span class="pun">[(</span><span class="pln">data_for_plot$padjust</span><span class="pun">&lt;=</span><span class="lit">0.05</span><span class="pun">&amp;</span><span class="pln">data_for_plot$log2FC</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="str">"up"</span></code></li><li class="L7"><code><span class="pln">data_for_plot$sig</span><span class="pun">[(</span><span class="pln">data_for_plot$padjust</span><span class="pun">&lt;=</span><span class="lit">0.05</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> data_for_plot$log2FC</span><span class="pun">&lt;=-</span><span class="lit">1</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="str">"down"</span></code></li><li class="L8"><code><span class="pln">summary</span><span class="pun">(</span><span class="pln">data_for_plot$sig</span><span class="pun">==</span><span class="str">"up"</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">summary</span><span class="pun">(</span><span class="pln">data_for_plot$sig</span><span class="pun">==</span><span class="str">"down"</span><span class="pun">)</span></code></li><li class="L0"><code><span class="pln">summary</span><span class="pun">(</span><span class="pln">data_for_plot$sig</span><span class="pun">==</span><span class="str">"NO"</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">x_lim </span><span class="pun">&lt;-</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">log2FC</span><span class="pun">,-</span><span class="pln">log2FC</span><span class="pun">)</span></code></li><li class="L2"><code><span class="pln">library</span><span class="pun">(</span><span class="pln">ggplot2</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">library</span><span class="pun">(</span><span class="typ">RColorBrewer</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">theme_set</span><span class="pun">(</span><span class="pln">theme_bw</span><span class="pun">())</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">p </span><span class="pun">&lt;-</span><span class="pln"> ggplot</span><span class="pun">(</span><span class="pln">data_for_plot</span><span class="pun">,</span><span class="pln">aes</span><span class="pun">(</span><span class="pln">log2FC</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">*</span><span class="pln">log10</span><span class="pun">(</span><span class="pln">padjust</span><span class="pun">),</span><span class="pln">color </span><span class="pun">=</span><span class="pln"> sig</span><span class="pun">))+</span><span class="pln">geom_point</span><span class="pun">()+</span><span class="pln">xlim</span><span class="pun">(-</span><span class="lit">4</span><span class="pun">,</span><span class="lit">4</span><span class="pun">)+</span><span class="pln">labs</span><span class="pun">(</span><span class="pln">x</span><span class="pun">=</span><span class="str">"log2RPF(RocA03/DMSO)"</span><span class="pun">,</span><span class="pln">y</span><span class="pun">=</span><span class="str">"-log10(p.adjust)"</span><span class="pun">)</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">p </span><span class="pun">&lt;-</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> scale_color_manual</span><span class="pun">(</span><span class="pln">values </span><span class="pun">=</span><span class="pln">c</span><span class="pun">(</span><span class="str">"#0072B5"</span><span class="pun">,</span><span class="str">"grey"</span><span class="pun">,</span><span class="str">"#BC3C28"</span><span class="pun">))+</span></code></li><li class="L9"><code><span class="pln">  geom_hline</span><span class="pun">(</span><span class="pln">yintercept</span><span class="pun">=-</span><span class="pln">log10</span><span class="pun">(</span><span class="lit">0.05</span><span class="pun">),</span><span class="pln">linetype</span><span class="pun">=</span><span class="lit">4</span><span class="pun">)+</span></code></li><li class="L0"><code><span class="pln">  geom_vline</span><span class="pun">(</span><span class="pln">xintercept</span><span class="pun">=</span><span class="pln">c</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">),</span><span class="pln">linetype</span><span class="pun">=</span><span class="lit">4</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">p </span><span class="pun">&lt;-</span><span class="pln"> p </span><span class="pun">+</span><span class="pln">theme</span><span class="pun">(</span><span class="pln">panel</span><span class="pun">.</span><span class="pln">grid </span><span class="pun">=</span><span class="pln">element_blank</span><span class="pun">())+</span></code></li><li class="L2"><code><span class="pln">    theme</span><span class="pun">(</span><span class="pln">axis</span><span class="pun">.</span><span class="pln">line </span><span class="pun">=</span><span class="pln"> element_line</span><span class="pun">(</span><span class="pln">size</span><span class="pun">=</span><span class="lit">0</span><span class="pun">))+</span><span class="pln">ylim</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">15</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">p </span><span class="pun">&lt;-</span><span class="pln"> p  </span><span class="pun">+</span><span class="pln">guides</span><span class="pun">(</span><span class="pln">colour </span><span class="pun">=</span><span class="pln"> FALSE</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">p </span><span class="pun">&lt;-</span><span class="pln"> p </span><span class="pun">+</span><span class="pln">theme</span><span class="pun">(</span><span class="pln">axis</span><span class="pun">.</span><span class="pln">text</span><span class="pun">=</span><span class="pln">element_text</span><span class="pun">(</span><span class="pln">size</span><span class="pun">=</span><span class="lit">20</span><span class="pun">),</span><span class="pln">axis</span><span class="pun">.</span><span class="pln">title</span><span class="pun">=</span><span class="pln">element_text</span><span class="pun">(</span><span class="pln">size</span><span class="pun">=</span><span class="lit">20</span><span class="pun">))</span></code></li><li class="L5"><code><span class="pln">p</span></code></li></ol></pre><p data-anchor-id="8ssy"><img src="http://static.zybuluo.com/sherking/jwwe2zyr2fck92zlw4brimyo/image_1g44i5vv811ek1p3a136ag0hl0a1g.png" alt="image_1g44i5vv811ek1p3a136ag0hl0a1g.png-37.4kB" title="">  </p><div class="md-section-divider"></div><h3 data-anchor-id="227p" id="figure-1e-f"><strong>Figure 1E-F</strong></h3><ul data-anchor-id="18os">
<li>Metagene analysis via <a href="https://github.com/xryanglab/RiboMiner" target="_blank">RiboMiner</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="x37e"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE70211_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO,RocA003,RocA03,RocA3'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1,DMSO-2__RocA-003__RocA-03__RocA-3'</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_up_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_down_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_RocA03_up_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_up_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li><li class="L5"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_RocA03_down_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_down_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><p data-anchor-id="miu9"><img src="http://static.zybuluo.com/sherking/z65cx8gjqlqniugefxx01twu/image_1g44irmrt1sio14nhj1q1haodpm1t.png" alt="image_1g44irmrt1sio14nhj1q1haodpm1t.png-186.9kB" title="">  </p><div class="md-section-divider"></div><h3 data-anchor-id="e4fm" id="figure-2a"><strong>Figure 2A</strong></h3><p data-anchor-id="2y6v">Disome-seq data analysis was finished by previous snakemake pipeline.</p><ul data-anchor-id="1bfb">
<li><a href="https://github.com/sherkinglee/RocA/blob/main/metadata/Disome_configure.txt" target="_blank">configure file</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="le2i"><ol class="linenums"><li class="L0"><code><span class="pln">bamFiles    readLengths </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L1"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1.Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  ALL </span><span class="lit">0</span><span class="pln">   </span><span class="lit">293FT</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="lit">1</span></code></li><li class="L2"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1.Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  ALL </span><span class="lit">0</span><span class="pln">   </span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="lit">1</span></code></li><li class="L3"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">2.Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  ALL </span><span class="lit">0</span><span class="pln">   </span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="lit">2</span></code></li></ol></pre><ul data-anchor-id="dfci">
<li>Metagene plot via <a href="https://github.com/xryanglab/RiboMiner" target="_blank">RiboMiner</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="h4cc"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="typ">Disome_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'293FT-DMSO,293FT-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'293FT-DMSO-1__293FT-RocA03-1,293FT-RocA03-2'</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_RUG_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">30</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_RDG_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">30</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_RocA03_RUG_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_RUG_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window y</span></code></li><li class="L4"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_RocA03_RDG_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_RDG_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window y</span></code></li></ol></pre><p data-anchor-id="fglx"><img src="http://static.zybuluo.com/sherking/iq56rg6ivlyic8eezpkpnwv5/image_1g44jeg5q1oju3vqtts1npcl262a.png" alt="image_1g44jeg5q1oju3vqtts1npcl262a.png-122.6kB" title=""> </p><p data-anchor-id="z8rt"><img src="http://static.zybuluo.com/sherking/pgyd908apmrtvo3r070j276c/image_1gi7qmofj112o1oupqcsoa13941g.png" alt="image_1gi7qmofj112o1oupqcsoa13941g.png-31.1kB" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="u3xw" id="figure-2b"><strong>Figure 2B</strong></h3><ul data-anchor-id="7l5w">
<li>Calculate disome density of the first 50 codons via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/ReadsLengthOfSpecificRegions.py" target="_blank">ReadsLengthOfSpecificRegions.py</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rtgl"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA_3D</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="typ">Disome_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'293FT-DMSO,293FT-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'293FT-DMSO-1__293FT-RocA03-1,293FT-RocA03-2'</span></code></li><li class="L9"><code><span class="pln">up_trans</span><span class="pun">=</span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code><span class="pln">down_trans</span><span class="pun">=</span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">mkdir $workdir</span><span class="pun">/</span><span class="typ">Length</span></code></li><li class="L3"><code></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">ReadsLengthOfSpecificRegions</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i $BamDir</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="pln">DMSO</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1.Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="typ">Length</span><span class="pun">/</span><span class="lit">293FT</span><span class="pln">_DMSO_1_RUG_100codons </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">150</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">ReadsLengthOfSpecificRegions</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i $BamDir</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">1.Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="typ">Length</span><span class="pun">/</span><span class="lit">293FT</span><span class="typ">_RocA03_1_RUG_100codons</span><span class="pln"> </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">150</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">ReadsLengthOfSpecificRegions</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i $BamDir</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_STAR</span><span class="pun">/</span><span class="lit">293FT</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">disome</span><span class="pun">-</span><span class="lit">2.Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam </span><span class="pun">-</span><span class="pln">o $workdir</span><span class="pun">/</span><span class="typ">Length</span><span class="pun">/</span><span class="lit">293FT</span><span class="typ">_RocA03_2_RUG_100codons</span><span class="pln"> </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">l </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r </span><span class="lit">150</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com">## plot in MicroSoft Excell</span></code></li></ol></pre><p data-anchor-id="vdbl"><img src="http://static.zybuluo.com/sherking/7qnhsc5ptw122g0a885vzamk/image_1gi7qntciimnh9m15ea1si31mjd1t.png" alt="image_1gi7qntciimnh9m15ea1si31mjd1t.png-45.1kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="3fm8" id="figure-2c-d"><strong>Figure 2C-D</strong></h3><ul data-anchor-id="yi6t">
<li>Calculate read coverage for each transcript via <a href="https://github.com/xryanglab/RiboMiner" target="_blank">RiboMiner</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="w6no"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="typ">Disome_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'293FT-DMSO,293FT-RocA03,HT-29-DMSO,HT-29-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'293FT-DMSO__293FT-RocA03__HT-29-DMSO__HT-29-RocA03'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="typ">CoverageOfEachTrans</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info  </span><span class="pun">-</span><span class="pln">o coverage</span><span class="pun">/</span><span class="pln">MA_RUG </span><span class="pun">--</span><span class="pln">mode coverage </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="typ">PlotTransCoverage</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i coverage</span><span class="pun">/</span><span class="pln">MA_RUG_293FT</span><span class="pun">-</span><span class="pln">DMSO_RPM_depth</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o coverage</span><span class="pun">/</span><span class="lit">293FT</span><span class="pln">_DMSO_NDUFS6 </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">t NDUFS6  </span><span class="pun">--</span><span class="pln">mode coverage </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type gene_name </span><span class="pun">--</span><span class="pln">color lightskyblue </span><span class="pun">--</span><span class="pln">type single</span><span class="pun">-</span><span class="pln">gene </span><span class="pun">--</span><span class="pln">ymax </span><span class="lit">30</span></code></li><li class="L3"><code><span class="typ">PlotTransCoverage</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i coverage</span><span class="pun">/</span><span class="pln">MA_RUG_293FT</span><span class="pun">-</span><span class="typ">RocA03_RPM_depth</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o coverage</span><span class="pun">/</span><span class="lit">293FT</span><span class="typ">_RocA03_NDUFS6</span><span class="pln"> </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">t NDUFS6  </span><span class="pun">--</span><span class="pln">mode coverage </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type gene_name </span><span class="pun">--</span><span class="pln">color lightskyblue </span><span class="pun">--</span><span class="pln">type single</span><span class="pun">-</span><span class="pln">gene </span><span class="pun">--</span><span class="pln">ymax </span><span class="lit">30</span></code></li></ol></pre><p data-anchor-id="ogyi"><img src="http://static.zybuluo.com/sherking/xwvpk8icxsn1fdxpxev0gymq/image_1gi7qclo7hjn1s8j8fqdtvdram.png" alt="image_1gi7qclo7hjn1s8j8fqdtvdram.png-20.2kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="1ug7" id="figure-3a"><strong>Figure 3A</strong></h3><ul data-anchor-id="ferl">
<li>Get gene sets for GO analysis: <a href="https://github.com/sherkinglee/RocA/blob/main/data/GO_analysis.txt" target="_blank">GO_analysis.txt</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="4499"><ol class="linenums"><li class="L0"><code><span class="pln">$ less </span><span class="pun">-</span><span class="pln">S GO_analysis</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="typ">RocA</span><span class="pun">-</span><span class="pln">up</span><span class="pun">-</span><span class="pln">regulated       </span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">down</span><span class="pun">-</span><span class="pln">regulated</span></code></li><li class="L2"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">ND5  RBBP7</span></code></li><li class="L3"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">ATP6 KPNB1</span></code></li><li class="L4"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">CYB  HNRNPD</span></code></li><li class="L5"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">ND4  HNRNPAB</span></code></li><li class="L6"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">ND1  SLC1A5</span></code></li><li class="L7"><code><span class="pln">HIST1H3B        HUWE1</span></code></li><li class="L8"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">CO3  XPO1</span></code></li><li class="L9"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">ND2  HNRNPF</span></code></li><li class="L0"><code><span class="pln">C1QBP   ATP2A2</span></code></li><li class="L1"><code><span class="pln">MT</span><span class="pun">-</span><span class="pln">CO2  CLTC</span></code></li><li class="L2"><code><span class="pln">GPI     ZNF711</span></code></li><li class="L3"><code><span class="pln">HIST1H4B        H2AFY</span></code></li><li class="L4"><code><span class="pln">LDHA    NUCKS1</span></code></li><li class="L5"><code><span class="pln">DYNC1H1 MYC</span></code></li><li class="L6"><code><span class="pln">HIST1H2AH       CTNNB1</span></code></li><li class="L7"><code><span class="pln">NUP205  YWHAE</span></code></li></ol></pre><ul data-anchor-id="da8m">
<li>Codes: <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/GO_analysis.R" target="_blank">GO_analysis.R</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="bylh"><ol class="linenums"><li class="L0"><code><span class="pln">setwd</span><span class="pun">(</span><span class="str">"../data"</span><span class="pun">)</span></code></li><li class="L1"><code><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="kwd">require</span><span class="pun">(</span><span class="str">"BiocManager"</span><span class="pun">,</span><span class="pln"> quietly </span><span class="pun">=</span><span class="pln"> TRUE</span><span class="pun">))</span></code></li><li class="L2"><code><span class="pln">    install</span><span class="pun">.</span><span class="pln">packages</span><span class="pun">(</span><span class="str">"BiocManager"</span><span class="pun">)</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="typ">BiocManager</span><span class="pun">::</span><span class="pln">install</span><span class="pun">(</span><span class="str">"clusterProfiler"</span><span class="pun">)</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">library</span><span class="pun">(</span><span class="pln">clusterProfiler</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">library</span><span class="pun">(</span><span class="pln">org</span><span class="pun">.</span><span class="typ">Hs</span><span class="pun">.</span><span class="pln">eg</span><span class="pun">.</span><span class="pln">db</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">GO_analysis </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"GO_analysis.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">fill </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">check</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">)</span></code></li><li class="L9"><code><span class="typ">RocA_insensitive</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> na</span><span class="pun">.</span><span class="pln">omit</span><span class="pun">(</span><span class="pln">GO_analysis$</span><span class="str">`RocA-up-regulated`</span><span class="pun">)</span></code></li><li class="L0"><code><span class="typ">RocA_sensitive</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> na</span><span class="pun">.</span><span class="pln">omit</span><span class="pun">(</span><span class="pln">GO_analysis$</span><span class="str">`RocA-down-regulated`</span><span class="pun">)</span></code></li><li class="L1"><code><span class="com">## construct dataframe</span></code></li><li class="L2"><code><span class="com"># up</span></code></li><li class="L3"><code><span class="typ">RocA_insensitive_entrezID</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> bitr</span><span class="pun">(</span><span class="typ">RocA_insensitive</span><span class="pun">,</span><span class="pln">fromType</span><span class="pun">=</span><span class="str">"SYMBOL"</span><span class="pun">,</span><span class="pln"> toType</span><span class="pun">=</span><span class="str">"ENTREZID"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">OrgDb</span><span class="pun">=</span><span class="str">"org.Hs.eg.db"</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">group_up </span><span class="pun">&lt;-</span><span class="pln"> rep</span><span class="pun">(</span><span class="str">"RocA-up-regulated"</span><span class="pun">,</span><span class="pln">times</span><span class="pun">=</span><span class="pln">length</span><span class="pun">(</span><span class="typ">RocA_insensitive_entrezID$ENTREZID</span><span class="pun">))</span></code></li><li class="L5"><code><span class="pln">data_up </span><span class="pun">&lt;-</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">geneID</span><span class="pun">=</span><span class="typ">RocA_insensitive_entrezID$ENTREZID</span><span class="pun">,</span><span class="kwd">group</span><span class="pun">=</span><span class="pln">group_up</span><span class="pun">)</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="com"># down</span></code></li><li class="L8"><code><span class="typ">RocA_sensitive_entrezID</span><span class="pln"> </span><span class="pun">&lt;-</span><span class="pln"> bitr</span><span class="pun">(</span><span class="typ">RocA_sensitive</span><span class="pun">,</span><span class="pln">fromType</span><span class="pun">=</span><span class="str">"SYMBOL"</span><span class="pun">,</span><span class="pln"> toType</span><span class="pun">=</span><span class="str">"ENTREZID"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">OrgDb</span><span class="pun">=</span><span class="str">"org.Hs.eg.db"</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">group_down </span><span class="pun">&lt;-</span><span class="pln"> rep</span><span class="pun">(</span><span class="str">"RocA-down-regulated"</span><span class="pun">,</span><span class="pln">times</span><span class="pun">=</span><span class="pln">length</span><span class="pun">(</span><span class="typ">RocA_sensitive_entrezID$ENTREZID</span><span class="pun">))</span></code></li><li class="L0"><code><span class="pln">data_down </span><span class="pun">&lt;-</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">geneID</span><span class="pun">=</span><span class="typ">RocA_sensitive_entrezID$ENTREZID</span><span class="pun">,</span><span class="kwd">group</span><span class="pun">=</span><span class="pln">group_down</span><span class="pun">)</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="com"># all</span></code></li><li class="L3"><code><span class="pln">data_all_GO </span><span class="pun">&lt;-</span><span class="pln"> rbind</span><span class="pun">(</span><span class="pln">data_up</span><span class="pun">,</span><span class="pln">data_down</span><span class="pun">)</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">formula </span><span class="pun">&lt;-</span><span class="pln"> compareCluster</span><span class="pun">(</span><span class="pln">geneID</span><span class="pun">~</span><span class="kwd">group</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">=</span><span class="pln">data_all_GO</span><span class="pun">,</span><span class="pln"> fun</span><span class="pun">=</span><span class="str">'enrichGO'</span><span class="pun">,</span><span class="typ">OrgDb</span><span class="pun">=</span><span class="str">'org.Hs.eg.db'</span><span class="pun">,</span><span class="pln">pvalueCutoff</span><span class="pun">=</span><span class="lit">0.05</span><span class="pun">,</span><span class="pln">pAdjustMethod </span><span class="pun">=</span><span class="pln"> </span><span class="str">"BH"</span><span class="pun">,</span><span class="pln">qvalueCutoff </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.05</span><span class="pun">,</span><span class="pln">ont</span><span class="pun">=</span><span class="str">"BP"</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">summary</span><span class="pun">(</span><span class="pln">formula</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">formula </span><span class="pun">&lt;-</span><span class="pln"> simplify</span><span class="pun">(</span><span class="pln">formula</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">y </span><span class="pun">&lt;-</span><span class="pln"> dotplot</span><span class="pun">(</span><span class="pln">formula</span><span class="pun">,</span><span class="pln">showCategory</span><span class="pun">=</span><span class="lit">20</span><span class="pun">,</span><span class="pln">includeAll</span><span class="pun">=</span><span class="pln">TRUE</span><span class="pun">)</span></code></li><li class="L9"><code><span class="pln">y</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">formula_dataframe </span><span class="pun">&lt;-</span><span class="pln"> </span><span class="kwd">as</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">frame</span><span class="pun">(</span><span class="pln">formula</span><span class="pun">)</span></code></li><li class="L2"><code><span class="pln">write</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="pln">formula_dataframe</span><span class="pun">,</span><span class="str">"GO_analysis_dataframe.txt"</span><span class="pun">,</span><span class="pln">quote </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">row</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">col</span><span class="pun">.</span><span class="pln">names </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="xx0j"><img src="http://static.zybuluo.com/sherking/2iyzyh05aw64m7d3uectzc92/image_1g44ksog5abl1i21hu3rvg1s0k3u.png" alt="image_1g44ksog5abl1i21hu3rvg1s0k3u.png-166.7kB" title="">  </p><p data-anchor-id="7w94">regenated in Excel:</p><p data-anchor-id="u0c8"><img src="http://static.zybuluo.com/sherking/b6zomnhmoxii00axdti3um2j/image_1gi7qp62q16psfj5160q1jm316gg2a.png" alt="image_1gi7qp62q16psfj5160q1jm316gg2a.png-51.1kB" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="qwcj" id="figure-3b-e"><strong>Figure 3B-E</strong></h3><ul data-anchor-id="bm3x">
<li>Fetch cds sequences for RUGs and RDGs via <a href="https://github.com/xryanglab/RiboMiner" target="_blank">RiboMiner</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ukfw"><ol class="linenums"><li class="L0"><code><span class="pln">$ </span><span class="typ">GetProteinCodingSequence</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">c </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="lit">643</span><span class="pln">_down </span><span class="pun">--</span><span class="pln">mode whole </span><span class="pun">--</span><span class="pln">table </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="lit">19636</span><span class="pln">  transcripts will be used </span><span class="kwd">in</span><span class="pln"> the follow analysis</span><span class="pun">.</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="typ">There</span><span class="pln"> are </span><span class="lit">642</span><span class="pln"> transcripts </span><span class="kwd">from</span><span class="pln"> </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt used </span><span class="kwd">for</span><span class="pln"> following analysis</span><span class="pun">.</span></code></li><li class="L4"><code><span class="pln">ENST00000625083 filtered</span><span class="pun">--</span><span class="typ">There</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> a ambiguous nucleotide N </span><span class="kwd">in</span><span class="pln"> your sequence</span></code></li><li class="L5"><code><span class="pln">ENST00000387347 filtered</span><span class="pun">--</span><span class="typ">There</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> a ambiguous nucleotide N </span><span class="kwd">in</span><span class="pln"> your sequence</span></code></li><li class="L6"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L7"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L8"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L9"><code><span class="typ">Notes</span><span class="pun">:</span><span class="pln"> </span><span class="typ">There</span><span class="pln"> are </span><span class="lit">3</span><span class="pln"> transcripts whose cds sequence cannot be divided </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span><span class="pun">!</span></code></li><li class="L0"><code><span class="typ">Finish</span><span class="pln"> the step of extracting sequences</span><span class="pun">!</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">$ </span><span class="typ">GetProteinCodingSequence</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">c </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="lit">374</span><span class="pln">_up </span><span class="pun">--</span><span class="pln">mode whole </span><span class="pun">--</span><span class="pln">table </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt   </span><span class="lit">19636</span><span class="pln">  transcripts will be used </span><span class="kwd">in</span><span class="pln"> the follow analysis</span><span class="pun">.</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="typ">There</span><span class="pln"> are </span><span class="lit">374</span><span class="pln"> transcripts </span><span class="kwd">from</span><span class="pln"> </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt used </span><span class="kwd">for</span><span class="pln"> following analysis</span><span class="pun">.</span></code></li><li class="L5"><code><span class="pln">ENST00000625083 filtered</span><span class="pun">--</span><span class="typ">There</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> a ambiguous nucleotide N </span><span class="kwd">in</span><span class="pln"> your sequence</span></code></li><li class="L6"><code><span class="pln">ENST00000387347 filtered</span><span class="pun">--</span><span class="typ">There</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> a ambiguous nucleotide N </span><span class="kwd">in</span><span class="pln"> your sequence</span></code></li><li class="L7"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L8"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L9"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L0"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L1"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L2"><code><span class="typ">Warning</span><span class="pun">:</span><span class="pln"> sequence </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> divisible </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L3"><code><span class="typ">Notes</span><span class="pun">:</span><span class="pln"> </span><span class="typ">There</span><span class="pln"> are </span><span class="lit">6</span><span class="pln"> transcripts whose cds sequence cannot be divided </span><span class="kwd">by</span><span class="pln"> </span><span class="lit">3</span><span class="pun">!</span></code></li><li class="L4"><code><span class="typ">Finish</span><span class="pln"> the step of extracting sequences</span><span class="pun">!</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">$ </span><span class="typ">GetProteinCodingSequence</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">c </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">MTGenes</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode whole </span><span class="pun">--</span><span class="pln">table </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="typ">MTGene_info</span><span class="pun">.</span><span class="pln">txt</span></code></li></ol></pre><ul data-anchor-id="2vhk">
<li>Calculate tAI, CAI, and charges</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="j3tz"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=.</span></code></li><li class="L1"><code><span class="pln">fasta</span><span class="pun">=./</span><span class="pln">data</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="typ">LabMember2</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">## 1 cAI</span></code></li><li class="L5"><code><span class="pln">cAI </span><span class="pun">-</span><span class="pln">i MT_Genes_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">374</span><span class="pln">_up_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">643</span><span class="pln">_down_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest_cds_sequences</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o CAI </span><span class="pun">-</span><span class="pln">t </span><span class="typ">MTGenes</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">up</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">down</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="pln">all </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">reference $Ref</span><span class="pun">/</span><span class="pln">longest_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">cAIPlot </span><span class="pun">-</span><span class="pln">i CAI_local_cAI_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o CAI </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode all </span><span class="pun">--</span><span class="pln">start </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">window </span><span class="lit">7</span><span class="pln"> </span><span class="pun">--</span><span class="pln">step </span><span class="lit">1</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="com">## 2 tAI</span></code></li><li class="L0"><code><span class="pln">tAI </span><span class="pun">-</span><span class="pln">i MT_Genes_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">374</span><span class="pln">_up_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">643</span><span class="pln">_down_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest_cds_sequences</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o tAI </span><span class="pun">-</span><span class="pln">t </span><span class="typ">MTGenes</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">up</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">down</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="pln">all </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">table </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln">N tRNA_GCNs_human</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">tAIPlot </span><span class="pun">-</span><span class="pln">i tAI_tAI_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o tAI </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">00</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode all </span><span class="pun">--</span><span class="pln">start </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">window </span><span class="lit">7</span><span class="pln"> </span><span class="pun">--</span><span class="pln">step </span><span class="lit">1</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="com">## 3 hydropathy and charge</span></code></li><li class="L4"><code><span class="pln">hydropathyCharge  </span><span class="pun">-</span><span class="pln">i MT_Genes_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">374</span><span class="pln">_up_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">643</span><span class="pln">_down_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest_cds_sequences</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">Hydro</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">MTGenes</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">up</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">down</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="pln">all </span><span class="pun">--</span><span class="pln">index hydropathy</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">table </span><span class="lit">1</span></code></li><li class="L5"><code><span class="pln">hydropathyCharge  </span><span class="pun">-</span><span class="pln">i MT_Genes_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">374</span><span class="pln">_up_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$fasta</span><span class="pun">/</span><span class="lit">643</span><span class="pln">_down_cds_sequences</span><span class="pun">.</span><span class="pln">fa</span><span class="pun">,</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest_cds_sequences</span><span class="pun">.</span><span class="pln">fa  </span><span class="pun">-</span><span class="pln">o </span><span class="typ">Charge</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">MTGenes</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">up</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="typ">RocA</span><span class="pun">-</span><span class="pln">down</span><span class="pun">-</span><span class="pln">regulated</span><span class="pun">,</span><span class="pln">all </span><span class="pun">--</span><span class="pln">index AA_charge</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">table </span><span class="lit">1</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="typ">PlotHydropathyCharge</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i </span><span class="typ">Hydro_values_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">Hydro</span><span class="pln"> </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode all </span><span class="pun">--</span><span class="pln">ylab </span><span class="str">"Average Hydrophobicity"</span></code></li><li class="L8"><code><span class="typ">PlotHydropathyCharge</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i </span><span class="typ">Charge_values_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">Charge</span><span class="pln"> </span><span class="pun">-</span><span class="pln">u </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode all </span><span class="pun">--</span><span class="pln">ylab </span><span class="str">"Average Charges"</span></code></li></ol></pre><p data-anchor-id="tnh2"><img src="http://static.zybuluo.com/sherking/i446i3uas7h42l2mns788i93/image_1gi7qq5hm1ktkvon8101c5nbo2n.png" alt="image_1gi7qq5hm1ktkvon8101c5nbo2n.png-133.8kB" title=""> </p><div class="md-section-divider"></div><h3 data-anchor-id="grvo" id="figure-4a"><strong>Figure 4A</strong></h3><ul data-anchor-id="f0gm">
<li>Motif identification via homer</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3lnp"><ol class="linenums"><li class="L0"><code><span class="pln">$ cat run_homer</span><span class="pun">.</span><span class="pln">sh</span></code></li><li class="L1"><code><span class="pln">findMotifs</span><span class="pun">.</span><span class="pln">pl </span><span class="lit">374</span><span class="pln">_up_CDS</span><span class="pun">.</span><span class="pln">fa human up_CDS </span><span class="pun">-</span><span class="pln">fasta </span><span class="pun">~</span><span class="str">/Reference/</span><span class="pln">human</span><span class="pun">/</span><span class="pln">longest_CDS</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L2"><code><span class="pln">findMotifs</span><span class="pun">.</span><span class="pln">pl </span><span class="lit">643</span><span class="pln">_down_CDS</span><span class="pun">.</span><span class="pln">fa human down_CDS </span><span class="pun">-</span><span class="pln">fasta </span><span class="pun">~</span><span class="str">/Reference/</span><span class="pln">human</span><span class="pun">/</span><span class="pln">longest_CDS</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">$ cat homer</span><span class="pun">-</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">up</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">motif</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">A   C   G   T</span></code></li><li class="L6"><code><span class="lit">0.686</span><span class="pln">   </span><span class="lit">0.032</span><span class="pln">   </span><span class="lit">0.248</span><span class="pln">   </span><span class="lit">0.034</span></code></li><li class="L7"><code><span class="lit">0.447</span><span class="pln">   </span><span class="lit">0.240</span><span class="pln">   </span><span class="lit">0.138</span><span class="pln">   </span><span class="lit">0.175</span></code></li><li class="L8"><code><span class="lit">0.037</span><span class="pln">   </span><span class="lit">0.026</span><span class="pln">   </span><span class="lit">0.884</span><span class="pln">   </span><span class="lit">0.053</span></code></li><li class="L9"><code><span class="lit">0.709</span><span class="pln">   </span><span class="lit">0.049</span><span class="pln">   </span><span class="lit">0.192</span><span class="pln">   </span><span class="lit">0.050</span></code></li><li class="L0"><code><span class="lit">0.028</span><span class="pln">   </span><span class="lit">0.215</span><span class="pln">   </span><span class="lit">0.550</span><span class="pln">   </span><span class="lit">0.207</span></code></li><li class="L1"><code><span class="lit">0.733</span><span class="pln">   </span><span class="lit">0.160</span><span class="pln">   </span><span class="lit">0.037</span><span class="pln">   </span><span class="lit">0.070</span></code></li><li class="L2"><code><span class="lit">0.040</span><span class="pln">   </span><span class="lit">0.689</span><span class="pln">   </span><span class="lit">0.207</span><span class="pln">   </span><span class="lit">0.064</span></code></li><li class="L3"><code><span class="lit">0.049</span><span class="pln">   </span><span class="lit">0.631</span><span class="pln">   </span><span class="lit">0.192</span><span class="pln">   </span><span class="lit">0.128</span></code></li><li class="L4"><code><span class="lit">0.677</span><span class="pln">   </span><span class="lit">0.157</span><span class="pln">   </span><span class="lit">0.045</span><span class="pln">   </span><span class="lit">0.121</span></code></li><li class="L5"><code><span class="lit">0.149</span><span class="pln">   </span><span class="lit">0.155</span><span class="pln">   </span><span class="lit">0.218</span><span class="pln">   </span><span class="lit">0.477</span></code></li></ol></pre><ul data-anchor-id="37i2">
<li>Select one polypurine motif in CDS of RUGs for plot via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/Seq2logo.R" target="_blank">Seq2logo.R</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ba7t"><ol class="linenums"><li class="L0"><code><span class="pln">setwd</span><span class="pun">(</span><span class="str">"../data"</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">library</span><span class="pun">(</span><span class="pln">seqLogo</span><span class="pun">)</span></code></li><li class="L2"><code><span class="pln">up_motif3 </span><span class="pun">&lt;-</span><span class="pln"> read</span><span class="pun">.</span><span class="pln">table</span><span class="pun">(</span><span class="str">"homer-RocA03-up-CDS-motif.txt"</span><span class="pun">,</span><span class="pln">sep</span><span class="pun">=</span><span class="str">"\t"</span><span class="pun">,</span><span class="pln">stringsAsFactors </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">,</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> T</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">up_motif3 </span><span class="pun">&lt;-</span><span class="pln"> t</span><span class="pun">(</span><span class="pln">up_motif3</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">seqLogo</span><span class="pun">(</span><span class="pln">up_motif3</span><span class="pun">,</span><span class="pln">ic</span><span class="pun">.</span><span class="pln">scale </span><span class="pun">=</span><span class="pln"> F</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="b0dy"><img src="http://static.zybuluo.com/sherking/ljqce3okk9uprvmw306ia8nj/image_1g44m2fnq7g47dv2iks261aqo55.png" alt="image_1g44m2fnq7g47dv2iks261aqo55.png-69.4kB" title="">  </p><div class="md-section-divider"></div><h3 data-anchor-id="f8cs" id="figure-4b"><strong>Figure 4B</strong></h3><ul data-anchor-id="ktw4">
<li>blast iCLIP-seq reads to CDS of RUGs</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="9hsd"><ol class="linenums"><li class="L0"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 374_up_CDS.fa -query ../05.contam/noncontam_SRR3238818.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out RocA3_to_RocA03_up_CDS.txt"</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 374_up_CDS.fa -query ../05.contam/noncontam_SRR3238817.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out RocA03_to_RocA03_up_CDS.txt"</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 374_up_CDS.fa -query ../05.contam/noncontam_SRR3238816.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out RocA003_to_RocA03_up_CDS.txt"</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 374_up_CDS.fa -query ../05.contam/noncontam_SRR3238815.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out DMSO2_to_RocA03_up_CDS.txt"</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">374</span><span class="pln">_up</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 374_up_CDS.fa -query ../05.contam/noncontam_SRR3238814.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out DMSO1_to_RocA03_up_CDS.txt"</span></code></li></ol></pre><ul data-anchor-id="5qxs">
<li>blast iCLIP-seq reads to 5UTR of RDGs</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="kxo6"><ol class="linenums"><li class="L0"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 643_down_5UTR.fa -query ../05.contam/noncontam_SRR3238818.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out RocA3_to_RocA03_down_5UTR.txt"</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 643_down_5UTR.fa -query ../05.contam/noncontam_SRR3238817.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out RocA03_to_RocA03_down_5UTR.txt"</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 643_down_5UTR.fa -query ../05.contam/noncontam_SRR3238816.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out RocA003_to_RocA03_down_5UTR.txt"</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 643_down_5UTR.fa -query ../05.contam/noncontam_SRR3238815.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out DMSO2_to_RocA03_down_5UTR.txt"</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">bsub </span><span class="pun">-</span><span class="pln">q TEST</span><span class="pun">-</span><span class="pln">A </span><span class="pun">-</span><span class="pln">n </span><span class="lit">4</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="pln">err </span><span class="pun">-</span><span class="pln">o </span><span class="lit">643</span><span class="pln">_down</span><span class="pun">.</span><span class="kwd">out</span><span class="pln"> </span><span class="str">"blastn -subject 643_down_5UTR.fa -query ../05.contam/noncontam_SRR3238814.fa -task blastn  -outfmt \"7 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue\" -out DMSO1_to_RocA03_down_5UTR.txt"</span></code></li></ol></pre><ul data-anchor-id="krep">
<li>Searching polyAG motifs via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/SearchPolypurineMotifs.py" target="_blank">SearchPolypurineMotifs.py</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="n1ll"><ol class="linenums"><li class="L0"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO1_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_up_CDS_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO2_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_up_CDS_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA003_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA03_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA3_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO1_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_down_5UTR_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO2_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_down_5UTR_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO1_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_up_CDS_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO2_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_up_CDS_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA003_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA03_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA3_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO1_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_up_CDS_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO2_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_up_CDS_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA003_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA03_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA3_to_RocA03_up_CDS_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_up_CDS_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO1_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_down_5UTR_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO2_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_down_5UTR_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO1_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_down_5UTR_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i DMSO2_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_down_5UTR_reads </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">SearchPolypurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads</span><span class="pln"> </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li></ol></pre><ul data-anchor-id="f0ik">
<li>statistic the frequency of poly-purine motifs</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="61us"><ol class="linenums"><li class="L0"><code><span class="com">## collapse UTR</span></code></li><li class="L1"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO1_to_RocA03_down_5UTR_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO1_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO1_to_RocA03_down_5UTR_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO1_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO1_to_RocA03_down_5UTR_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO1_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO2_to_RocA03_down_5UTR_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO2_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO2_to_RocA03_down_5UTR_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO2_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO2_to_RocA03_down_5UTR_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO2_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="com">## collapse CDS</span></code></li><li class="L2"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO1_to_RocA03_up_CDS_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO1_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO1_to_RocA03_up_CDS_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO1_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO1_to_RocA03_up_CDS_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO1_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO2_to_RocA03_up_CDS_reads_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO2_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO2_to_RocA03_up_CDS_reads_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO2_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code><span class="pln">less </span><span class="pun">-</span><span class="pln">S DMSO2_to_RocA03_up_CDS_reads_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">|</span><span class="pln">cut </span><span class="pun">-</span><span class="pln">f </span><span class="lit">3</span><span class="pun">|</span><span class="pln">sort </span><span class="pun">|</span><span class="pln">uniq </span><span class="pun">-</span><span class="pln">c </span><span class="pun">|</span><span class="pln">awk </span><span class="pun">-</span><span class="pln">F </span><span class="str">" "</span><span class="pln"> </span><span class="str">'BEGIN{OFS="\t"}{print $2,$1}'</span><span class="pln"> </span><span class="pun">|</span><span class="pln">sort </span><span class="pun">&gt;</span><span class="pln"> DMSO2_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt</span></code></li></ol></pre><ul data-anchor-id="na48">
<li>Calculate motif score via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/PolypurineMotifScore.py" target="_blank">PolypurineMotifScore.py</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8vkz"><ol class="linenums"><li class="L0"><code><span class="com"># statistic motif score</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238814</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO1_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238815</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO2_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238816</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238817</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238818</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_4_mer_collapsed</span></code></li><li class="L6"><code></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238814</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO1_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238815</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO2_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238816</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238817</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238818</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_4_mer_collapsed</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238814</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO1_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238815</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO2_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238816</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238817</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238818</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_5_mer_collapsed</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238814</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO1_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238815</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO2_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238816</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238817</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238818</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_5_mer_collapsed</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238814</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO1_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238815</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO2_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238816</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238817</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238818</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_up_CDS_reads_polyAG_6_mer_collapsed</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238814</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO1_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO1_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238815</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m DMSO2_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o DMSO2_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238816</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA003_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238817</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA03_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PolypurineMotifScore</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="pun">../</span><span class="lit">05.contam</span><span class="pun">/</span><span class="pln">noncontam_SRR3238818</span><span class="pun">.</span><span class="pln">fa </span><span class="pun">-</span><span class="pln">m </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o </span><span class="typ">RocA3_to_RocA03_down_5UTR_reads_polyAG_6_mer_collapsed</span></code></li></ol></pre><ul data-anchor-id="901v">
<li>Calculate motif enrichment (RocA motif score/DMSO motif score) in Excel</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="yd04"><ol class="linenums"><li class="L0"><code><span class="pun">.</span><span class="str">/results/</span><span class="typ">Figure</span><span class="pln"> </span><span class="lit">4B</span><span class="pun">.</span><span class="pln">xlsx</span></code></li></ol></pre><p data-anchor-id="dczr"><img src="http://static.zybuluo.com/sherking/65ucwm54aciph7fe1utmhkb3/image_1g44nofoj76v17t97ns1al21r4f5i.png" alt="image_1g44nofoj76v17t97ns1al21r4f5i.png-78.8kB" title="">  </p><div class="md-section-divider"></div><h3 data-anchor-id="cgy5" id="figure-4c"><strong>Figure 4C</strong></h3><ul data-anchor-id="6uax">
<li>Calculate density around poly-purine motifs via <a href="https://github.com/sherkinglee/RocA/blob/main/scripts/RiboDensityAroundPolyPurineMotifs.py" target="_blank">RiboDensityAroundPolyPurineMotifs.py</a></li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="86ar"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="typ">Project</span><span class="pun">/</span><span class="lit">05.Ribo</span><span class="pln">_seq_human</span><span class="pun">/</span><span class="pln">GSE70211</span><span class="pun">/</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA_HEK293</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE70211_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">up_trans</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">down_trans</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="com">## poly-purine</span></code></li><li class="L2"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">## UTR</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L6"><code><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L8"><code><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L0"><code><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L3"><code><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L5"><code><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="com">## CDS</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_regulated_genes_info</span><span class="pun">.</span><span class="pln">txt  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li></ol></pre><ul data-anchor-id="r6l0">
<li>polyAG, polyAC and polyCT motifs</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="hqhz"><ol class="linenums"><li class="L0"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="lit">4mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">motif</span></code></li><li class="L2"><code><span class="pln">GGAA</span></code></li><li class="L3"><code><span class="pln">GAAA</span></code></li><li class="L4"><code><span class="pln">AAAA</span></code></li><li class="L5"><code><span class="pln">AGAA</span></code></li><li class="L6"><code><span class="pln">AAGG</span></code></li><li class="L7"><code><span class="pln">AGGA</span></code></li><li class="L8"><code><span class="pln">GAAG</span></code></li><li class="L9"><code><span class="pln">AGAG</span></code></li><li class="L0"><code><span class="pln">AAAG</span></code></li><li class="L1"><code><span class="pln">GAGA</span></code></li><li class="L2"><code><span class="pln">AAGA</span></code></li><li class="L3"><code><span class="pln">AGGG</span></code></li><li class="L4"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="lit">4mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">motifs</span></code></li><li class="L6"><code><span class="pln">AAAC</span></code></li><li class="L7"><code><span class="pln">AACA</span></code></li><li class="L8"><code><span class="pln">AACC</span></code></li><li class="L9"><code><span class="pln">ACAA</span></code></li><li class="L0"><code><span class="pln">ACAC</span></code></li><li class="L1"><code><span class="pln">ACCA</span></code></li><li class="L2"><code><span class="pln">ACCC</span></code></li><li class="L3"><code><span class="pln">CAAA</span></code></li><li class="L4"><code><span class="pln">CAAC</span></code></li><li class="L5"><code><span class="pln">CACA</span></code></li><li class="L6"><code><span class="pln">CACC</span></code></li><li class="L7"><code><span class="pln">CCAA</span></code></li><li class="L8"><code><span class="pln">CCAC</span></code></li><li class="L9"><code><span class="pln">CCCA</span></code></li><li class="L0"><code><span class="pln">CCCC</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">CCCC</span></code></li><li class="L4"><code><span class="pln">CCCT</span></code></li><li class="L5"><code><span class="pln">CCTC</span></code></li><li class="L6"><code><span class="pln">CCTT</span></code></li><li class="L7"><code><span class="pln">CTCC</span></code></li><li class="L8"><code><span class="pln">CTCT</span></code></li><li class="L9"><code><span class="pln">CTTC</span></code></li><li class="L0"><code><span class="pln">CTTT</span></code></li><li class="L1"><code><span class="pln">TCCC</span></code></li><li class="L2"><code><span class="pln">TCCT</span></code></li><li class="L3"><code><span class="pln">TCTC</span></code></li><li class="L4"><code><span class="pln">TCTT</span></code></li><li class="L5"><code><span class="pln">TTCC</span></code></li><li class="L6"><code><span class="pln">TTCT</span></code></li><li class="L7"><code><span class="pln">TTTC</span></code></li><li class="L8"><code><span class="pln">TTTT</span></code></li></ol></pre><ul data-anchor-id="gtkc">
<li>Calculate mean density between replicates</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3obi"><ol class="linenums"><li class="L0"><code><span class="com">## 01. calculate mean</span></code></li><li class="L1"><code><span class="pln">mkdir counts_10_mean_kmer</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="com">## CDS</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_4_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_4_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_4_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_5_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_5_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_5_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_6_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_6_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_6_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">cp counts_10</span><span class="pun">/</span><span class="pln">hek293t_</span><span class="pun">*.</span><span class="pln">txt counts_10_mean_kmer</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com">## UTR</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyAC_4_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyAG_4_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyCT_4_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyAC_5_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyAG_5_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyCT_5_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyAC_6_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyAG_6_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6mer</span><span class="pun">-</span><span class="lit">5UTR</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">MeanRiboDensityAroundPolyPurineMotifsFiltered</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">txt</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_DMSO_polyCT_6_mer </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li></ol></pre><ul data-anchor-id="iy2l">
<li>Calculate ratio between RocA and DMSO</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="lzra"><ol class="linenums"><li class="L0"><code><span class="com">## 02. calculate ratio</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span></code></li><li class="L2"><code><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_4_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="com">#python CalRiboDensityRatioFilter.py -c counts_10_mean_kmer/hek293t_DMSO_polyAC_5_mer_mean.txt -t counts_10_mean_kmer/hek293t_RocA-03_polyAC_5_mer.txt -o counts_10_mean_kmer/hek293t_RocA-03_polyAC_5_mer.ratio --kmer 5mer-CDS-AC.txt</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAC_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AC</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyAG_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CDS</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatioFilter</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">c counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_DMSO_polyCT_5_mer_mean</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">t counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5mer</span><span class="pun">-</span><span class="pln">CT</span><span class="pun">.</span><span class="pln">txt</span></code></li></ol></pre><ul data-anchor-id="0ftg">
<li>plot the ratio values</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="713h"><ol class="linenums"><li class="L0"><code><span class="com"># 03. plot ratio</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_4_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_4_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_4_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L4"><code></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_4_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_4_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_4_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_5_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_5_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_5_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L3"><code></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_5_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_5_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_5_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L8"><code></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_6_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_6_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_6_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_6_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_6_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_6_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="com">## UTR</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_UTR_4_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_UTR_4_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_UTR_4_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_UTR_4_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_UTR_4_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_UTR_4_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L6"><code></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_UTR_5_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_UTR_5_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_UTR_5_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_UTR_5_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_UTR_5_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_UTR_5_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_UTR_6_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_UTR_6_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_UTR_6_mer</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">003</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA003_UTR_6_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA003</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">03</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA03_UTR_6_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10_mean_kmer</span><span class="pun">/</span><span class="pln">hek293t_UTR_RocA</span><span class="pun">-</span><span class="lit">3</span><span class="pln">_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10_mean_kmer</span><span class="pun">/</span><span class="typ">RocA3_UTR_6_mer_AG_CT</span><span class="pln"> </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA3</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">50</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">50</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li></ol></pre><p data-anchor-id="g604"><img src="http://static.zybuluo.com/sherking/2opxwads8v5m5ln2utri86cp/image_1gi7qup88bv79if5a13b03vg34.png" alt="image_1gi7qup88bv79if5a13b03vg34.png-220.9kB" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="xd00" id="figure-4d"><strong>Figure 4D</strong></h3><ul data-anchor-id="xihl">
<li>Calculate disome density around polypurine moitfs</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="y1ne"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=~</span><span class="str">/Reference/</span><span class="pln">human</span><span class="pun">/</span><span class="pln">hg38</span><span class="pun">/</span><span class="pln">ensemble</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=~</span><span class="str">/Reference/</span><span class="pln">human</span><span class="pun">/</span><span class="pln">hg38</span><span class="pun">/</span><span class="pln">ensemble</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">test</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="typ">Disome_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">up_trans</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">down_trans</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="com"># poly-purine</span></code></li><li class="L2"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">## UTR</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L6"><code><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L8"><code><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L0"><code><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L1"><code></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L4"><code><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L6"><code><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span></code></li><li class="L8"><code><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L9"><code></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans  </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L3"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_5UTR </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type </span><span class="lit">5UTR</span><span class="pln"> </span><span class="pun">-</span><span class="pln">S $down_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="com">## CDS</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li><li class="L3"><code></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AG</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> AC</span></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">RiboDensityAroundPolyPurineMotifs</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o polymotifs</span><span class="pun">/</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F $transcript </span><span class="pun">--</span><span class="pln">kmer </span><span class="lit">6</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type CDS </span><span class="pun">-</span><span class="pln">S $up_trans </span><span class="pun">--</span><span class="pln">id</span><span class="pun">-</span><span class="pln">type transcript_id </span><span class="pun">--</span><span class="kwd">base</span><span class="pln"> CT</span></code></li></ol></pre><ul data-anchor-id="csin">
<li>Calculate ratio</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="895q"><ol class="linenums"><li class="L0"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyAG_4_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyAG_5_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyAG_6_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyAC_4_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyAC_5_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L6"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyAC_6_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyAC_6_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyCT_4_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L9"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyCT_5_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li><li class="L0"><code><span class="pln">python </span><span class="typ">CalRiboDensityRatio</span><span class="pun">.</span><span class="pln">py counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="pln">DMSO_polyCT_6_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT</span><span class="pun">-</span><span class="typ">RocA03_polyCT_6_mer</span><span class="pun">.</span><span class="pln">txt counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio</span></code></li></ol></pre><ul data-anchor-id="d1l7">
<li>Plot ratio</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="u0ww"><ol class="linenums"><li class="L0"><code><span class="com"># 03. plot ratio</span></code></li><li class="L1"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAC_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_4mer_AG_AC </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L2"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_4_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyCT_4_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_4mer_AG_CT </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAC_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_5mer_AG_AC </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L5"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_5_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyCT_5_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_5mer_AG_CT </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAC_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_6mer_AG_AC </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AC </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li><li class="L8"><code><span class="pln">python </span><span class="typ">PlotRatio</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i  counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyAG_6_mer</span><span class="pun">.</span><span class="pln">ratio</span><span class="pun">,</span><span class="pln">counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_RocA03_polyCT_6_mer</span><span class="pun">.</span><span class="pln">ratio </span><span class="pun">-</span><span class="pln">o counts_10</span><span class="pun">/</span><span class="pln">test_CDS_293FT_6mer_AG_CT </span><span class="pun">-</span><span class="pln">t </span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">AG</span><span class="pun">,</span><span class="typ">RocA03</span><span class="pun">-</span><span class="pln">CT </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">100</span><span class="pln">  </span><span class="pun">--</span><span class="pln">slide</span><span class="pun">-</span><span class="pln">window</span></code></li></ol></pre><p data-anchor-id="7eq0"><img src="http://static.zybuluo.com/sherking/cqq7ezg8ekkqfytrdgj9hma8/image_1g44omlubf5610fs1knmkv417g16c.png" alt="image_1g44omlubf5610fs1knmkv417g16c.png-148.3kB" title="">  </p><div class="md-section-divider"></div><h3 data-anchor-id="fag3" id="figure-4e"><strong>Figure 4E</strong></h3><ul data-anchor-id="aet7">
<li>Metagene analysis via RiboMiner</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="hmas"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">GSE102720_configure</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'Naive-DMSO,Naive-RocA03,Aglaiacized-DMSO,Aglaiacized-RocA03'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'Naive-DMSO-1,Naive-DMSO-2__Naive-RocA03__Aglaiacized-DMSO-1,Aglaiacized-DMSO-2__Aglaiacized-RocA03'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $results</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_up_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_down_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_RocA03_up_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_up_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li><li class="L6"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_RocA03_down_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_RocA03_down_unnormed </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><p data-anchor-id="9iy3"><img src="http://static.zybuluo.com/sherking/usiokgh8lfv91rhltgdop7kc/image_1g44p5goovo911derh415lcal36p.png" alt="image_1g44p5goovo911derh415lcal36p.png-105kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="7q6i" id="figure-4f"><strong>Figure 4F</strong></h3><p data-anchor-id="6f2z">This is similar to Figure 4C and Figure 4D</p><p data-anchor-id="n5r3"><img src="http://static.zybuluo.com/sherking/4yixe01uvs432f5pq5cicqa6/image_1gi7te0a413ed1vakfs81gh21i0l4b.png" alt="image_1gi7te0a413ed1vakfs81gh21i0l4b.png-74.2kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="7rpl" id="figure-6a"><strong>Figure 6A</strong></h3><ul data-anchor-id="nuff">
<li>configure files for 4 tumor cell samples</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="hb4x"><ol class="linenums"><li class="L0"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">attributes_375</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L1"><code><span class="pln">bamFiles    readLengths </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L2"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542147_STAR</span><span class="pun">/</span><span class="pln">SRR11542147</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">   </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">   DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pun">-</span><span class="lit">375</span></code></li><li class="L3"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542148_STAR</span><span class="pun">/</span><span class="pln">SRR11542148</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">   </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">   DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pun">-</span><span class="lit">375</span></code></li><li class="L4"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542155_STAR</span><span class="pun">/</span><span class="pln">SRR11542155</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">    </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">    </span><span class="typ">RocA03</span><span class="pun">-</span><span class="lit">375</span></code></li><li class="L5"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542156_STAR</span><span class="pun">/</span><span class="pln">SRR11542156</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">    </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">    </span><span class="typ">RocA3</span><span class="pun">-</span><span class="lit">375</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">attributes_520</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">bamFiles    readLengths </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L9"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542143_STAR</span><span class="pun">/</span><span class="pln">SRR11542143</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">    </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">    DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pun">-</span><span class="lit">520</span></code></li><li class="L0"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542144_STAR</span><span class="pun">/</span><span class="pln">SRR11542144</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">    </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">    DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pun">-</span><span class="lit">520</span></code></li><li class="L1"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542151_STAR</span><span class="pun">/</span><span class="pln">SRR11542151</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">    </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">    </span><span class="typ">RocA03</span><span class="pun">-</span><span class="lit">520</span></code></li><li class="L2"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542152_STAR</span><span class="pun">/</span><span class="pln">SRR11542152</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">25</span><span class="pun">,</span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">    </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">    </span><span class="typ">RocA3</span><span class="pun">-</span><span class="lit">520</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">attributes_936</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="pln">bamFiles    readLengths </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L6"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542145_STAR</span><span class="pun">/</span><span class="pln">SRR11542145</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">   </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">   DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pun">-</span><span class="lit">936</span></code></li><li class="L7"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542146_STAR</span><span class="pun">/</span><span class="pln">SRR11542146</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">   </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">   DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pun">-</span><span class="lit">936</span></code></li><li class="L8"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542153_STAR</span><span class="pun">/</span><span class="pln">SRR11542153</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">26</span><span class="pun">,</span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">   </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">   </span><span class="typ">RocA03</span><span class="pun">-</span><span class="lit">936</span></code></li><li class="L9"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542154_STAR</span><span class="pun">/</span><span class="pln">SRR11542154</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">27</span><span class="pun">,</span><span class="lit">28</span><span class="pun">,</span><span class="lit">29</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pln">  </span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pln">  </span><span class="typ">RocA3</span><span class="pun">-</span><span class="lit">936</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">$ cat </span><span class="pun">./</span><span class="pln">data</span><span class="pun">/</span><span class="pln">attributes_1650</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L2"><code><span class="pln">bamFiles    readLengths </span><span class="typ">Offsets</span><span class="pln"> bamLegends</span></code></li><li class="L3"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542141_STAR</span><span class="pun">/</span><span class="pln">SRR11542141</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pun">,</span><span class="lit">32</span><span class="pun">,</span><span class="lit">33</span><span class="pun">,</span><span class="lit">34</span><span class="pln">  </span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pln">  DMSO</span><span class="pun">-</span><span class="lit">1</span><span class="pun">-</span><span class="lit">1650</span></code></li><li class="L4"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542142_STAR</span><span class="pun">/</span><span class="pln">SRR11542142</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pun">,</span><span class="lit">32</span><span class="pun">,</span><span class="lit">33</span><span class="pun">,</span><span class="lit">34</span><span class="pln">  </span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pln">  DMSO</span><span class="pun">-</span><span class="lit">2</span><span class="pun">-</span><span class="lit">1650</span></code></li><li class="L5"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542149_STAR</span><span class="pun">/</span><span class="pln">SRR11542149</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pun">,</span><span class="lit">32</span><span class="pun">,</span><span class="lit">33</span><span class="pun">,</span><span class="lit">34</span><span class="pln">  </span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pln">  </span><span class="typ">RocA03</span><span class="pun">-</span><span class="lit">1650</span></code></li><li class="L6"><code><span class="pun">../</span><span class="lit">07.STAR</span><span class="pun">/</span><span class="pln">SRR11542150_STAR</span><span class="pun">/</span><span class="pln">SRR11542150</span><span class="pun">.</span><span class="typ">Aligned</span><span class="pun">.</span><span class="pln">toTranscriptome</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">sorted</span><span class="pun">.</span><span class="pln">bam  </span><span class="lit">30</span><span class="pun">,</span><span class="lit">31</span><span class="pun">,</span><span class="lit">32</span><span class="pun">,</span><span class="lit">33</span><span class="pun">,</span><span class="lit">34</span><span class="pln">  </span><span class="lit">12</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="lit">13</span><span class="pln">  </span><span class="typ">RocA3</span><span class="pun">-</span><span class="lit">1650</span></code></li></ol></pre><ul data-anchor-id="haic">
<li>Metagene analysis via RiboMiner</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3dy0"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA_375</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">attributes_375</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO-375,RocA03-375,RocA3-375'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1-375,DMSO-2-375__RocA03-375__RocA3-375'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $results</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_375_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_375_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_375_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_375_unnormed_RocA03</span><span class="pun">-</span><span class="pln">down </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li><li class="L6"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_375_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_375_unnormed_RocA03</span><span class="pun">-</span><span class="pln">up </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ubg0"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA_520</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">attributes_520</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO-520,RocA03-520,RocA3-520'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1-520,DMSO-2-520__RocA03-520__RocA3-520'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $results</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_520_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_520_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_520_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_520_unnormed_RocA03</span><span class="pun">-</span><span class="pln">down </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li><li class="L6"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_520_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_520_unnormed_RocA03</span><span class="pun">-</span><span class="pln">up </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="jca1"><ol class="linenums"><li class="L0"><code></code></li><li class="L1"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L2"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L3"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L4"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L5"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA_936</span></code></li><li class="L6"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">attributes_936</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L8"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO-936,RocA03-936,RocA3-936'</span></code></li><li class="L9"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1-936,DMSO-2-936__RocA03-936__RocA3-936'</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $results</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_936_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_936_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L5"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_936_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_936_unnormed_RocA03</span><span class="pun">-</span><span class="pln">down </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li><li class="L6"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_936_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_936_unnormed_RocA03</span><span class="pun">-</span><span class="pln">up </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="11b1"><ol class="linenums"><li class="L0"><code><span class="pln">workdir</span><span class="pun">=</span><span class="str">`pwd`</span></code></li><li class="L1"><code><span class="typ">BamDir</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/../</span><span class="lit">07.STAR</span></code></li><li class="L2"><code><span class="typ">Ref</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span></code></li><li class="L3"><code><span class="pln">transcript</span><span class="pun">=</span><span class="str">/workdata/</span><span class="pln">home</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">lifj</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="typ">Reference</span><span class="pun">/</span><span class="pln">human</span><span class="pun">/</span><span class="typ">RiboCode_annot_Human</span><span class="pun">/</span><span class="typ">RiboCode_annot</span><span class="pun">/</span><span class="pln">transcripts_sequence</span><span class="pun">.</span><span class="pln">fa</span></code></li><li class="L4"><code><span class="pln">results</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">MA_1650</span></code></li><li class="L5"><code><span class="pln">attribute</span><span class="pun">=</span><span class="pln">$workdir</span><span class="pun">/</span><span class="pln">attributes_1650</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L6"><code><span class="pln">trans_info</span><span class="pun">=</span><span class="pln">$Ref</span><span class="pun">/</span><span class="pln">longest</span><span class="pun">.</span><span class="pln">transcripts</span><span class="pun">.</span><span class="pln">info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L7"><code><span class="pln">groups</span><span class="pun">=</span><span class="str">'DMSO-1650,RocA03-1650,RocA3-1650'</span></code></li><li class="L8"><code><span class="pln">replicates</span><span class="pun">=</span><span class="str">'DMSO-1-1650,DMSO-2-1650__RocA03-1650__RocA3-1650'</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">mkdir </span><span class="pun">-</span><span class="pln">p $results</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_1650_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">643</span><span class="pln">_down_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L3"><code><span class="typ">MetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">f $attribute </span><span class="pun">-</span><span class="pln">c $trans_info </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_1650_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed </span><span class="pun">-</span><span class="pln">U codon </span><span class="pun">-</span><span class="pln">M RPKM </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">m </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-</span><span class="pln">e </span><span class="lit">5</span><span class="pln"> </span><span class="pun">--</span><span class="pln">norm </span><span class="kwd">no</span><span class="pln"> </span><span class="pun">-</span><span class="pln">y </span><span class="lit">100</span><span class="pln"> </span><span class="pun">--</span><span class="pln">CI </span><span class="lit">0.95</span><span class="pln"> </span><span class="pun">--</span><span class="pln">type UTR </span><span class="pun">-</span><span class="pln">S </span><span class="lit">374</span><span class="pln">_up_genes_info</span><span class="pun">.</span><span class="pln">txt</span></code></li><li class="L4"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_1650_RocA03</span><span class="pun">-</span><span class="pln">down_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_1650_unnormed_RocA03</span><span class="pun">-</span><span class="pln">down </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li><li class="L5"><code><span class="typ">PlotMetageneAnalysis</span><span class="pln"> </span><span class="pun">-</span><span class="pln">i $results</span><span class="pun">/</span><span class="pln">MA_1650_RocA03</span><span class="pun">-</span><span class="pln">up_unnormed_dataframe</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">-</span><span class="pln">o $results</span><span class="pun">/</span><span class="pln">MA_1650_unnormed_RocA03</span><span class="pun">-</span><span class="pln">up </span><span class="pun">-</span><span class="pln">g $groups </span><span class="pun">-</span><span class="pln">r $replicates </span><span class="pun">-</span><span class="pln">u </span><span class="lit">100</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="lit">400</span><span class="pln"> </span><span class="pun">--</span><span class="pln">mode mean</span></code></li></ol></pre><p data-anchor-id="xrhs"><img src="http://static.zybuluo.com/sherking/n01o92qp7ovfi19zzbdnv3fl/image_1g44pvbssen11tmkndn1m7o92o76.png" alt="image_1g44pvbssen11tmkndn1m7o92o76.png-354.6kB">  </p><div class="md-section-divider"></div><h3 data-anchor-id="vwwh" id="figure-6b"><strong>Figure 6B</strong></h3><p data-anchor-id="bu82">The methods are the same as that for Figure 4C and Figure 4D</p><p data-anchor-id="2d1d"><img src="http://static.zybuluo.com/sherking/ywzswq02wnxmgtzzxrgndb1f/image_1gi7r8sbo133o191d1vvq1j83th33u.png" alt="image_1gi7r8sbo133o191d1vvq1j83th33u.png-271.6kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="zcmd" id="figure-7-the-model-of-translation-regulation-of-roca"><strong>Figure 7: the model of translation regulation of RocA</strong></h3><p data-anchor-id="yxxt">RDGs=IRGs <br>
RUGs=ERGs</p><p data-anchor-id="pgn8"><img src="http://static.zybuluo.com/sherking/wz08wla0gezxleiqqnt2xq0c/image_1g44qd4e51ker7c43k1sfm10i080.png" alt="image_1g44qd4e51ker7c43k1sfm10i080.png-126.2kB" title=""></p></div>
</body>
</html>